!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Pinia"),require("Vue"),require("VueRouter"),require("furaVue"),require("llescaVue"),require("pdfFonts"),require("pdfMake")):"function"==typeof define&&define.amd?define(["Pinia","Vue","VueRouter","furaVue","llescaVue","pdfFonts","pdfMake"],t):"object"==typeof exports?exports.app=t(require("Pinia"),require("Vue"),require("VueRouter"),require("furaVue"),require("llescaVue"),require("pdfFonts"),require("pdfMake")):e.app=t(e.Pinia,e.Vue,e.VueRouter,e.furaVue,e.llescaVue,e.pdfFonts,e.pdfMake)}(self,((e,t,a,n,l,i,o)=>(()=>{"use strict";var r={744:(e,t)=>{t.Z=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}},713:t=>{t.exports=e},740:e=>{e.exports=t},88:e=>{e.exports=a},283:e=>{e.exports=n},111:e=>{e.exports=l},732:e=>{e.exports=i},525:e=>{e.exports=o}},d={};function u(e){var t=d[e];if(void 0!==t)return t.exports;var a=d[e]={exports:{}};return r[e](a,a.exports,u),a.exports}u.d=(e,t)=>{for(var a in t)u.o(t,a)&&!u.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{u.d(s,{default:()=>ai});var e={};u.r(e),u.d(e,{getRoutes:()=>Va});var t={};u.r(t),u.d(t,{getRoutes:()=>qn});var a={};u.r(a),u.d(a,{getRoutes:()=>jn});var n=u(740),l=u(713),i=u(283),o=u(111),r=u(88);function d(e){const t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(a)}function c(e){if("string"==typeof e&&e){const t=d(e),a=1e3*t.exp,n=1e3*t.iat,l=Date.now();return n<l&&l<a}return!1}const m=(0,l.defineStore)({id:"session",state(){const e=localStorage.getItem("jwt");return{jwt:c(e)?e:null}},getters:{data:e=>function(e){if("string"==typeof e&&e){const t=d(e);return{name:t.unique_name,role:t.role}}return{name:null,role:null}}(e.jwt)},actions:{setJwt(e){"string"==typeof e&&e&&c(e)?(localStorage.setItem("jwt",e),this.jwt=e):(localStorage.removeItem("jwt"),this.jwt=null)}}}),p={__name:"details-cell-boolean",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.computed)((()=>t.row[t.field.name]));return(e,t)=>{const l=(0,n.resolveComponent)("fura-icon");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[!0===(0,n.unref)(a)||1===(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,class:"detailsCellBoolean-true",name:"CheckMark"})):((0,n.openBlock)(),(0,n.createBlock)(l,{key:1,class:"detailsCellBoolean-false",name:"Cancel"}))])}}};var f=u(744);const y=(0,f.Z)(p,[["__scopeId","data-v-3f173500"]]),v={__name:"form-field-boolean",props:{label:{type:String,default:void 0},boxSide:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},nullable:{type:Boolean,default:void 0}},emits:["change"],setup(e,{emit:t}){const a=e;a.validations?.createField(a.name??a.field.name,(0,n.computed)((()=>a.entity[a.name??a.field.name])));const l=(0,n.computed)((()=>(a.nullable??a.field.nullable)&&null===a.entity[a.name??a.field.name]));function i(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(t,a)=>{const o=(0,n.resolveComponent)("fura-checkbox");return(0,n.openBlock)(),(0,n.createElementBlock)("div",null,[(0,n.createVNode)(o,{label:e.label??e.field.label,"box-side":e.boxSide??e.field.boxSide,disabled:e.disabled??e.field.disabled,readonly:e.readonly??e.field.readonly,indeterminate:(0,n.unref)(l),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":i},null,8,["label","box-side","disabled","readonly","indeterminate","model-value"])])}}},g=(0,f.Z)(v,[["__scopeId","data-v-3c73bac8"]]),b={__name:"grid-field-boolean",props:{boxSide:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},nullable:{type:Boolean,default:void 0}},emits:["change"],setup(e,{emit:t}){const a=e;return(e,l)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(g),(0,n.mergeProps)({...a,label:""},{class:"field",onChange:l[0]||(l[0]=e=>t("change",e))}),null,16))}};function h(e,t){return t[e.name]?"Sí":!1===t[e.name]?"No":""}const C={detailsCell:y,formField:g,gridField:(0,f.Z)(b,[["__scopeId","data-v-4b941038"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition(e){if("eq"===e.operation)return`${e.name} eq @${e.name}`},getFilterInterface(e){if("eq"===e.operation)return{type:"checkbox",name:e.name,label:e.label}},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"boolean"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:h,getCsvValueFromEntity:h},x={eq:40,ne:30,gt:70,ge:50,lt:80,le:60,and:20,or:10,add:100,sub:90,mul:130,div:120,mod:110,has:150,in:140},w=Object.keys(x),N=["cast","ceiling","concat","contains","date","day","endswith","fractionalseconds","floor","hassubsequence","hassubset","hour","indexof","isof","length","matchesPattern","maxdatetime","mindatetime","minute","month","now","replace","round","second","startswith","substring","substringof","time","tolower","totaloffsetminutes","totalseconds","toupper","trim","year"],V=["all","any"];class I extends Error{constructor(e,t,a){super(`${e}. Starting at position ${t} and ending at ${a}.`),this.displayMessage=e,this.indexStart=t,this.indexEnd=a}}const S=new RegExp(`^(${w.join("|")})\\b`,"i"),B=new RegExp(`^(${N.join("|")})\\b`,"i"),k=new RegExp(`^(${["not","true","false","null","NaN","INF"].join("|")})\\b`);function E(e){return function(t,a){const n=t.substring(a),[l]=n.match(e);return{value:l,newIndex:a+l.length}}}const A=[{name:"EOS",test:(e,t)=>t>=e.length,reader:(e,t)=>({value:null,newIndex:e.length})},{name:"WHITESPACE",test:(e,t)=>/\s/.test(e[t]??""),reader:E(/^(\s+)/)},{name:"LITERAL",test:(e,t)=>"$"===e[t],reader:E(/^(\$[a-zA-Z]\w+)/)},{name:"ALIAS",test:(e,t)=>"@"===e[t],reader:E(/^(@[a-zA-Z]\w+)/)},{name:"GUID",test:(e,t)=>/^\d{8}-\d{4}-\d{4}-\d{4}-\d{12}/.test(e.substring(t)),reader:E(/^(\d{8}-\d{4}-\d{4}-\d{4}-\d{12})/)},{name:"DATE",test:(e,t)=>/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)/.test(e.substring(t)),reader:function(e,t){const a=E(/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z))/)(e,t);return a.value=new Date(a.value),a}},{name:"NUMBER",test:(e,t)=>/^-?\d/.test(e.substring(t)),reader:function(e,t){const a=E(/^(-?\d+(?:\.\d+)?(?:e-?\d+)?)/)(e,t);return a.value=Number(a.value),a}},{name:"PUNCTUATION",test:(e,t)=>["/","(",")","[","]",",",".",":","-"].includes(e[t]),reader:(e,t)=>({value:e[t],newIndex:t+1})},{name:"STRING",test:(e,t)=>"'"===e[t],reader:function(e,t){let a="",n=t+1,l=!0;for(;l;){if(n>=e.length)throw new I("Unclosed string",t,n);const i=e[n];n+=1,"'"===i?"'"===e[n]?(a+="'",n+=1):l=!1:a+=i}return{value:a,newIndex:n}}},{name:"OPERATOR",test:(e,t)=>S.test(e.substring(t)),reader:E(S)},{name:"FUNCTION",test:(e,t)=>B.test(e.substring(t)),reader:E(B)},{name:"KEYWORD",test:(e,t)=>k.test(e.substring(t)),reader:E(k)},{name:"NAME",test:(e,t)=>/[a-zA-Z]/.test(e[t]??""),reader:E(/^\w*/)}];function O(e,t){for(const a of A)if(a.test(e,t)){const{value:n,newIndex:l}=a.reader(e,t);return{type:a.name,value:n,indexStart:Math.min(t,e.length),indexEnd:l}}throw new I(`Unexpected character '${e[t]}'`,t,t+1)}function D(e,t){let a=O(e,t);for(;"WHITESPACE"===a.type;)a=O(e,a.indexEnd);return a}function $(e){return T(e)}function T(e){if(e.check("PUNCTUATION","(")){e.advance("PUNCTUATION","(");const t=_(e);return e.advance("PUNCTUATION",")"),t}if(e.check("PUNCTUATION","[")){e.advance("PUNCTUATION","[");const t=_(e);return e.advance("PUNCTUATION","]"),t}if(e.check("KEYWORD",["true","false"]))return function(e){return{type:"boolean",value:e.advance("KEYWORD",["true","false"]).value}}(e);if(e.check("KEYWORD",["null","NaN","INF"]))return function(e){return{type:"constant",value:e.advance("KEYWORD",["null","NaN","INF"]).value}}(e);if(e.check("DATE"))return function(e){return{type:"date",value:e.advance("DATE").value}}(e);if(e.check("NUMBER"))return function(e){return{type:"number",value:e.advance("NUMBER").value}}(e);if(e.check("GUID"))return function(e){return{type:"guid",value:e.advance("GUID").value}}(e);if(e.check("STRING"))return function(e){return{type:"string",value:e.advance("STRING").value}}(e);if(e.check("ALIAS"))return function(e){return{type:"alias",value:e.advance("ALIAS").value}}(e);if(e.check("PUNCTUATION","-")||e.check("KEYWORD","not"))return function(e){return e.check("PUNCTUATION","-")?e.advance("PUNCTUATION","-"):e.check("KEYWORD","not")&&e.advance("KEYWORD","not"),{type:"negative",value:T(e)}}(e);if(e.check("FUNCTION"))return function(e){const t=e.advance("FUNCTION"),a=function(e){const t=[];let a=!0;for(e.advance("PUNCTUATION","(");!e.check("EOS")&&!e.check("PUNCTUATION",")");)a?a=!1:e.advance("PUNCTUATION",","),t.push($(e));return e.advance("PUNCTUATION",")"),t}(e);return{type:"functionCall",name:t.value,parameters:a}}(e);if(e.check("NAME")||e.check("LITERAL"))return function(e){const t=[];for(;e.check(["NAME","LITERAL"])&&e.checkNext("PUNCTUATION","/");)t.push(e.advance(["NAME","LITERAL"]).value),e.advance("PUNCTUATION","/");if(V.some((t=>e.check("NAME",t)))&&e.checkNext("PUNCTUATION","(")){const a=e.advance("NAME").value;e.advance("PUNCTUATION","(");const n=e.advance("NAME").value;e.advance("PUNCTUATION",":");const l=q(e);return e.advance("PUNCTUATION",")"),{type:"lambda",navigation:t.length>0?t:null,operation:a,name:n,expression:l}}if(e.check("NAME"))return{type:"property",navigation:t.length>0?t:null,value:e.advance("NAME").value};if(e.check("LITERAL"))return{type:"literal",navigation:t.length>0?t:null,value:e.advance("LITERAL").value};throw new I(`Unexpected token ${e.current.type}.`,e.current.indexStart,e.current.indexEnd)}(e);throw new I(`Unexpected token ${e.current.type}.`,e.current.indexStart,e.current.indexEnd)}function _(e){const t=[q(e)];for(;e.check("PUNCTUATION",",");)e.advance("PUNCTUATION",","),t.push(q(e));return{type:"collection",value:t}}function F(e,t,a=0){if(e.check("OPERATOR")){const n=x[e.current.value];if(n>a){const l=e.advance("OPERATOR").value,i=F(e,T(e),n);return F(e,{type:"binaryOp",operator:l,left:t,right:i},a)}}return t}function q(e){if(e.check("PUNCTUATION","(")){e.advance("PUNCTUATION","(");const t=_(e);return e.advance("PUNCTUATION",")"),F(e,t)}if(e.check("PUNCTUATION","[")){e.advance("PUNCTUATION","[");const t=_(e);return e.advance("PUNCTUATION","]"),F(e,t)}return F(e,T(e))}const R={collection:e=>1===e.value.length?P(e.value[0]):e.value.map(P),boolean(e){if("true"===e.value)return!0;if("false"===e.value)return!1;throw new Error},constant(e){if("null"===e.value)return null;if("NaN"===e.value)return NaN;if("INF"===e.value)return Number.POSITIVE_INFINITY;throw new Error},date:e=>e.value,number:e=>e.value,string:e=>e.value,guid:e=>({guid:e.value}),alias:e=>({alias:e.value}),negative:e=>({not:U(e.value)}),functionCall:e=>({[e.name]:e.parameters.map(U)}),lambda:e=>({lambda:e.operation,path:e.navigation?.join("/"),name:e.name,expression:P(e.expression)}),property:e=>({property:Array.isArray(e.navigation)?[...e.navigation,e.value].join("/"):e.value}),literal:e=>({literal:Array.isArray(e.navigation)?[...e.navigation,e.value].join("/"):e.value})};function U(e){return Array.isArray(e)?e.map((e=>P(e))):e.type in R?R[e.type](e):void 0}function j(e){if(["and","or","add","sub","mul","div"].includes(e.operator)){const t=[],a=a=>"binaryOp"===a.type&&a.operator===e.operator?t.push(...j(a)[e.operator]):t.push(P(a));return a(e.left),a(e.right),{[e.operator]:t}}return{[e.operator]:[P(e.left),P(e.right)]}}function P(e){return"collection"===e.type?1===e.value.length&&["binaryOp","collection","lambda","functionCall"].includes(e.value[0].type)?P(e.value[0]):e.value.map(P):"binaryOp"===e.type?j(e):U(e)}function M(e){const t=function(e){let t=0,a=D(e,t),n=D(e,a.indexEnd);return t=n.indexEnd,{get current(){return a},get next(){return n},check(e,t){if(null!=e){if(Array.isArray(e))return e.includes(a.type);if(e!==a.type)return!1}if(null!=t){if(Array.isArray(t))return t.includes(a.value);if(t!==a.value)return!1}return!0},checkNext(e,t){if(null!=e){if(Array.isArray(e))return e.includes(n.type);if(e!==n.type)return!1}if(null!=t){if(Array.isArray(t))return t.includes(n.value);if(t!==n.value)return!1}return!0},advance(l,i){if(null!=l)if(Array.isArray(l)){if(!l.includes(a.type))throw new I(`Expected a token with a set of types, but found '${a.type}'`,a.indexStart,a.indexEnd)}else if(a.type!==l)throw new I(`Expected a token with type '${l}', but found '${a.type}'`,a.indexStart,a.indexEnd);if(null!=i)if(Array.isArray(i)){if(!i.includes(a.value))throw new I(`Expected a token with a set of values, but found '${a.value}'`,a.indexStart,a.indexEnd)}else if(a.value!==i)throw new I(`Expected a token with value '${i}', but found '${a.value}'`,a.indexStart,a.indexEnd);const o=a;return a=n,n=D(e,t),t=n.indexEnd,o},advanceIfExists(e,t){if(e&&a.type!==e)return null;if(null!=t)if(Array.isArray(t)){if(!t.includes(a.value))return null}else if(a.value!==t)return null;return this.advance(e,t)}}}(e);var a;return P(F(a=t,q(a)))}function K(e,t){if(void 0===e||"symbol"==typeof e)return;if(null===e)return"null";if(e===Number.POSITIVE_INFINITY)return"INF";if(e===isNaN)return"NaN";if(e instanceof Date)return e.toISOString();if("string"==typeof e)return e.includes("'")?`'${e.replace(/'/g,"''")}'`:`'${e}'`;if("number"==typeof e||"bigint"==typeof e||"boolean"==typeof e)return String(e);if(e.not)return"-"+K(e.not,t);if(Array.isArray(e))return`(${e.map((e=>K(e,t))).join()})`;if(e.lambda)return`${e.path}/${e.lambda}(${e.name}:${K(e.expression,t)})`;if(e.guid)return e.guid;if(e.alias){const a=e.alias.substring(1),n=Array.isArray(t)&&t.find((([e])=>e===a));return n?K(n[1],t):e.alias}if(e.property)return e.property;if(e.literal)return e.literal;const a=N.find((t=>t in e));if(a)return Array.isArray(e[a])?`${a}(${e[a].map((e=>K(e,t))).join()})`:`${a}(${K(e[a],t)})`;const n=w.find((t=>t in e));if(n)return`(${e[n].map((e=>K(e,t))).join(` ${n} `)})`;throw new Error("El filtro odata no se reconoce.")}const L={collection(e,t,a,n){for(let l=0;l<e.length;l+=1)if(z(e[l],t,a,[...n,l]))return!0},negative(e,t,a,n){if("pre"===a.order){if(t(e,n))return!0;if(z(e.not,t,a,[...n,"not"]))return!0}else if("post"===a.order){if(z(e.not,t,a,[...n,"not"]))return!0;if(t(e,n))return!0}},functionCall(e,t,a,n){const l=N.find((t=>t in e));if("pre"===a.order){if(t(e,n))return!0;if(L.collection(e[l],t,a,[...n,l]))return!0}else if("post"===a.order){if(L.collection(e[l],t,a,[...n,l]))return!0;if(t(e,n))return!0}},lambda(e,t,a,n){const l=`${e.path}/${e.lambda}`;if("pre"===a.order){if(t(e,n))return!0;if(z(e.expression,t,a,[...n,l]))return!0}else if("post"===a.order){if(z(e.expression,t,a,[...n,l]))return!0;if(t(e,n))return!0}},operators(e,t,a,n){const l=w.find((t=>t in e));if("pre"===a.order){if(t(e,n))return!0;if(L.collection(e[l],t,a,[...n,l]))return!0}else if("post"===a.order){if(L.collection(e[l],t,a,[...n,l]))return!0;if(t(e,n))return!0}}};function z(e,t,a={order:"post"},n=[]){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e||e===isNaN||e===Number.POSITIVE_INFINITY||e instanceof Date||e.guid||e.alias||e.property||e.literal?t(e,n):Array.isArray(e)?L.collection(e,t,a,n):e.not?L.negative(e,t,a,n):N.some((t=>t in e))?L.functionCall(e,t,a,n):e.lambda?L.lambda(e,t,a,n):w.some((t=>t in e))?L.operators(e,t,a,n):void 0}function G(e,t,a){if(Array.isArray(a)&&"string"==typeof e?.alias&&1===Object.keys(e).length)return a.push([e.alias.substring(1),t]),!0;if(typeof e==typeof t){if(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length){const n=Array.isArray(a)?[]:null;let l=!0;for(let a=0;a<e.length;a+=1){const i=G(e[a],t[a],n);if(!1===i)return!1;Array.isArray(i)&&(l=i)}return l&&n?.length>0&&a.push(...n),l}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if("object"==typeof e){const n=Object.keys(e),l=Object.keys(t);if(n.length===l.length&&n.every((e=>l.includes(e)))){const l=Array.isArray(a)?[]:null;let i=!0;for(const a of n){const n=G(e[a],t[a],l);if(!1===n)return!1;Array.isArray(n)&&(i=n)}return i&&l?.length>0&&a.push(...l),i}}return e===t}return!1}class W{constructor(e,t=null){this.conditions=[];for(const t of e)if(t instanceof W)this.conditions.push(t);else{if("string"!=typeof t)throw new Error;{const e=M(t),a=[];z(e,((e,t)=>{e.alias&&a.push({name:e.alias.substring(1),path:e.path})})),this.conditions.push({filter:t,structure:e,aliases:a})}}this.aggrupationOperation=t}getConditionValue(e){const t=[];for(const a of this.conditions)if(a instanceof W){const n=a.getConditionValue(e);n.length>0&&t.push(...n)}else G(a.structure,e,t);return t}readFilter(e){if(!this.aggrupationOperation)throw new Error;const t=[];if(e){const a=M(e),n=Array.isArray(a[this.aggrupationOperation])?[a,...a[this.aggrupationOperation]]:[a];for(const e of n){const a=this.getConditionValue(e);a.length>0&&t.push(...a)}}return t}findValuesInFilter(e){const t=[];return z(M(e),(e=>{const a=this.getConditionValue(e);a.length>0&&t.push(...a)})),t}writeFilter(e){if(!this.aggrupationOperation)throw new Error;const t=[];for(const a of this.conditions)if(a instanceof W){const n=a.writeFilter(e);n&&t.push(n)}else a.aliases.every((t=>e.some((([e])=>t.name===e))))&&t.push(K(a.structure,e));return t.length>0?`(${t.join(` ${this.aggrupationOperation} `)})`:""}}const Z=["textContent"],H={__name:"details-cell-generic",props:{field:{type:Object,default:void 0},row:{type:Object,default:void 0}},setup(e){const t=e,a=(0,n.ref)("");return(0,n.watchEffect)((async()=>{if(t.field&&t.row){const e=ht[t.field.type];a.value="function"==typeof e?.getTextValueFromEntity?await e.getTextValueFromEntity(t.field,t.row):t.row[t.field.name]}else a.value=""})),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{textContent:(0,n.toDisplayString)(a.value)},null,8,Z))}},X=(0,f.Z)(H,[["__scopeId","data-v-29f5092a"]]);function Y(e,t){return t[e.navigationKey]?.["@odata.count"]??""}const Q={detailsCell:X,getDetailsODataQuery:e=>({$expand:`${e.navigationKey}($count=true;$top=0)`}),getOrderbySentence:e=>`${e.navigationKey}/$count`,getFilterCondition:e=>"eq"===e.operation?`${e.navigationKey}/$count eq @${e.name}`:"between"===e.operation?new W([`${e.navigationKey}/$count gt @${e.name}_gt`,`${e.navigationKey}/$count lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"number",name:e.name,label:e.label}:"between"===e.operation?[{type:"number",name:`${e.name}_gt`,label:`${e.label} Menor`},{type:"number",name:`${e.name}_lt`,label:`${e.label} Major`}]:void 0,getTextValueFromEntity:Y,getCsvValueFromEntity:Y},J={__name:"form-field-choice",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},options:{type:Array,default:void 0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>(a.options||a.field.options).map((e=>"string"==typeof e?{value:e,text:e}:e))));function i(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,o)=>{const r=(0,n.resolveComponent)("llesca-field-dropdown");return(0,n.openBlock)(),(0,n.createBlock)(r,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,options:(0,n.unref)(l),placeholder:e.placeholder??e.field.placeholder,readonly:e.readonly??e.field.readonly,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":i,onFocus:o[0]||(o[0]=e=>t("focus",e)),onBlur:o[1]||(o[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","options","placeholder","readonly","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","model-value"])}}};function ee({focusHandler:e,blurHandler:t,$emit:a}={}){const l=(0,n.ref)(!1),i=(0,n.computed)((()=>!l.value));return{focus:l,borderless:i,handleFocus(t){l.value=!0,e?.(t),a?.("focus",t)},handleBlur(e){l.value=!1,t?.(e),a?.("blur",e)}}}const te={__name:"grid-field-choice",props:{invalid:{type:Boolean,default:void 0},options:{type:Array,default:void 0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(J),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};function ae(e,t){return t[e.name]??""}const ne={detailsCell:X,formField:J,gridField:(0,f.Z)(te,[["__scopeId","data-v-ce6a5b82"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface(e){if(["eq","in"].includes(e.operation))return{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation}},loadCache:async e=>e.options.map((e=>"string"==typeof e?{value:e,text:e}:e)),getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:ae,getCsvValueFromEntity:ae},le={__name:"form-field-date",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},notWritable:{type:Boolean,default:void 0},days:{type:Array,default:void 0},months:{type:Array,default:void 0},goToday:{type:String,default:void 0},firstDayOfTheWeek:{type:Number,default:void 0},today:{type:Date,default:void 0},parse:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},createField:{type:Function,default:void 0},stringify:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Date,default:void 0},max:{type:Date,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e;function l(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-date");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,placeholder:e.placeholder??e.field.placeholder,"not-writable":e.notWritable??e.field.notWritable,days:e.days??e.field.days,months:e.months??e.field.months,"go-today":e.goToday??e.field.goToday,"first-day-of-the-week":e.firstDayOfTheWeek??e.field.firstDayOfTheWeek,today:e.today??e.field.today,parse:e.parse??e.field.parse,"stringify-focus":e.stringifyFocus??e.field.stringifyFocus,stringify:e.stringify??e.field.stringify,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,min:e.min??e.field.min,max:e.max??e.field.max,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":l,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","placeholder","not-writable","days","months","go-today","first-day-of-the-week","today","parse","stringify-focus","stringify","required","disabled","min","max","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},ie={__name:"grid-field-date",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},notWritable:{type:Boolean,default:void 0},days:{type:Array,default:void 0},months:{type:Array,default:void 0},goToday:{type:String,default:void 0},firstDayOfTheWeek:{type:Number,default:void 0},today:{type:Date,default:void 0},parse:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},createField:{type:Function,default:void 0},stringify:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Date,default:void 0},max:{type:Date,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(le),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};function oe(e,t=2){return e.toString().padStart(t,"0")}function re(e,t){if(!t[e.name])return"";const a=new Date(t[e.name]);return a?`${oe(a.getDate())}/${oe(a.getMonth()+1)}/${oe(a.getFullYear(),4)}`:void 0}const de={detailsCell:X,formField:le,gridField:(0,f.Z)(ie,[["__scopeId","data-v-1980b3b4"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"between"===e.operation?new W([`${e.name} gt @${e.name}_gt`,`${e.name} lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"date",name:e.name,label:e.label}:"between"===e.operation?[{type:"date",name:`${e.name}_gt`,label:`${e.label} Menor`},{type:"date",name:`${e.name}_lt`,label:`${e.label} Major`}]:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name],dateKeys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):e.defaultValue instanceof Date&&(t[e.name]=new Date(e.defaultValue.getTime())))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:re,getCsvValueFromEntity:re},ue=(0,l.defineStore)({id:"dialog",state:()=>({loading:new Set,alertList:[],confirmList:[]}),actions:{loadStart(e){this.loading.add(e)},loadEnd(e){this.loading.delete(e)},alert(e){this.alertList.push(e)},alertClose(){const e=this.alertList.shift();if("function"==typeof e?.close)return e.close()},confirm(e){this.confirmList.push(e)},confirmAccept(){const e=this.confirmList.shift();if("function"==typeof e?.accept)return e.accept()},confirmCancel(){const e=this.confirmList.shift();if("function"==typeof e?.cancel)return e.cancel()}}}),se="tramitador",ce="Càrrega de tràmits",me="https://tramitador20.azurewebsites.net",pe="LLESCA_VIEW",fe="ID",ye="ENTITY",ve="VIEWNAME",ge="DEF_VIEW",be="DEFAULT_VIEW",he="/home";async function Ce(e,t,a){const n=ue();a||n.loadStart(e);try{const a=await t();return n.loadEnd(e),a}catch(t){throw n.loadEnd(e),t}}function xe(e,t,a={},{withoutDialog:n=!1}={}){return Ce(Symbol("requestGet"),(()=>o.odata.requestGet([me,e].flat(),t,{Authorization:m().jwt,...a})),n)}function we(e,t,a={},{withoutDialog:n=!1}={}){return Ce(Symbol("requestDelete"),(()=>o.odata.requestDelete([me,e].flat(),t,{Authorization:m().jwt,...a})),n)}function Ne(e){const t=[],a=[];for(const n of e){const l=ht[n.type];if(l){const i=l.getDetailsODataQuery(n,e);i.$select&&!t.includes(i.$select)&&t.push(i.$select),!i.$expand||a.includes(i.$expand)||a.some((e=>e.startsWith(i.$expand)||i.$expand.startsWith(e)))||a.push(i.$expand)}}return{$select:t.length>0?t:void 0,$expand:a.length>0?a:void 0}}function Ve(e){return ht[e.type]?.getOrderbySentence(e)}function Ie(e,t,{notOverwrite:a}={}){for(const n of e.fields)ht[n.type].setDetaultValueToEntity?.(n,t,{notOverwrite:a})}function Se(e){return Object.fromEntries(qt().filter((e=>"dictionary"===e.type)).map((t=>[t.name,"function"==typeof e?e():e])))}const Be=(0,l.defineStore)({id:"dictionary",state:()=>({data:Se(null),loading:Se((()=>({state:!1,callbacks:null})))}),actions:{loadDictionary(e,{force:t=!1}={}){const a=(0,n.unref)(e);if(qt(a)&&"dictionary"===qt(a).type){if(this.loading[a].state)return new Promise((e=>{this.loading[a].callbacks.push(e)}));if(!this.data[a]||t)return new Promise((e=>{const t=ue();this.loading[a].state=!0,this.loading[a].callbacks=[],t.loadStart(`dictionary/${a}/load`),xe(a,{...Ne(qt(a).fields)}).then((n=>{this.data[a]=n.value,t.loadEnd(`dictionary/${a}/load`);const l=[e,...this.loading[a].callbacks];this.loading[a].state=!1,this.loading[a].callbacks=null,l.forEach((e=>e()))}))}))}return Promise.resolve()}}});function ke(e,t){const a=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{const l=e.filter??e.field.filter,i=e.useFilter??e.field.useFilter;a.value="function"==typeof l?(0,n.unref)(t).filter(l):"function"==typeof i?(0,n.unref)(t).filter(i(e.entity)):(0,n.unref)(t)})),{filteredData:a}}const Ee={__name:"form-field-dictionary",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=Be(),i=(0,n.computed)((()=>a.entityName??a.field.entityName)),o=(0,n.shallowRef)([]);(0,n.watch)(i,(async e=>{await l.loadDictionary(e),o.value=l.data[e]}),{immediate:!0});const{filteredData:r}=ke(a,o),d=(0,n.computed)((()=>qt(i.value))),u=(0,n.computed)((()=>d.value.fields.find((e=>e.primary)).name)),s=(0,n.computed)((()=>d.value.fields.find((e=>e.defaultField)).name)),c=(0,n.computed)((()=>r.value.map((e=>({value:e[u.value],text:e[s.value]})))));function m(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(c),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":m,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},Ae={__name:"grid-field-dictionary",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ee),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};async function Oe(e,t){const a=Be();await a.loadDictionary(e.entityName);const n=qt(e.entityName),l=n.fields.find((e=>e.primary)).name,i=n.fields.find((e=>e.defaultField)).name,o=t[e.name],r=a.data[e.entityName]?.find((e=>e[l]===o));return r?.[i]??""}const De={detailsCell:X,formField:Ee,gridField:(0,f.Z)(Ae,[["__scopeId","data-v-3c8d511f"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>`${e.navigationKey||e.entityName}/${qt(e.entityName).fields.find((e=>e.defaultField)).name}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.navigationKey||e.entityName}/${qt(e.entityName).fields.find((e=>e.defaultField)).name}, @${e.name})`:void 0,getFilterInterface(e){if("eq"===e.operation){const t=qt(e.entityName);return{type:"combo",name:e.name,label:e.label,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("in"===e.operation){const t=qt(e.entityName);return{type:"combo",name:e.name,label:e.label,multiple:!0,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("contains"===e.operation)return{type:"text",name:e.name,label:e.label}},async loadCache(e){const t=Be();return await t.loadDictionary(e.entityName),t.data[e.entityName]},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:Oe,getCsvValueFromEntity:Oe},$e={__name:"form-field-dictionary-multi",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionDictionaryKey:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=Be(),i=(0,n.computed)((()=>a.entityName??a.field.entityName)),o=(0,n.shallowRef)([]);(0,n.watch)(i,(async e=>{await l.loadDictionary(e),o.value=l.data[e]}),{immediate:!0});const{filteredData:r}=ke(a,o),d=(0,n.computed)((()=>qt(i.value))),u=(0,n.computed)((()=>d.value.fields.find((e=>e.primary)).name)),s=(0,n.computed)((()=>d.value.fields.find((e=>e.defaultField)).name)),c=(0,n.computed)((()=>r.value.map((e=>({value:e[u.value],text:e[s.value]}))))),m=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),p=(0,n.computed)({get(){const e=a.junctionDictionaryKey??a.field.junction.dictionaryKey;return a.entity[m.value].map((t=>t[e]))},set(e){const n=a.junctionDictionaryKey??a.field.junction.dictionaryKey;t("change",(t=>{const a=t[m.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(c),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(p),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.isRef)(p)?p.value=e:null),onFocus:l[1]||(l[1]=e=>t("focus",e)),onBlur:l[2]||(l[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},Te={__name:"grid-field-dictionary-multi",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionDictionaryKey:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)($e),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};async function _e(e,t){const a=Be();await a.loadDictionary(e.entityName);const n=qt(e.entityName),l=n.fields.find((e=>e.primary)).name,i=n.fields.find((e=>e.defaultField)).name,o=e.junction.navigationKey||e.junction.name,r=a.data[e.entityName];return t[o]?.map((t=>r?.find((a=>a[l]===t[e.junction.dictionaryKey]))?.[i])).filter((e=>e)).join(", ")||""}const Fe={detailsCell:X,formField:$e,gridField:(0,f.Z)(Te,[["__scopeId","data-v-e6e02e5c"]]),getDetailsODataQuery:e=>({$expand:`${e.junction.navigationKey||e.junction.name}($select=${e.junction.primaryKey},${e.junction.dictionaryKey})`}),getOrderbySentence:e=>null,getFilterCondition(e){const t=e.junction.navigationKey||e.junction.name;return"in"===e.operation?`${t}/any(o: o/${e.junction.dictionaryKey} in @${e.name})`:"contains"===e.operation?`contains(${t}/${qt(e.entityName).fields.find((e=>e.defaultField)).name}, @${e.name})`:void 0},getFilterInterface(e){if("in"===e.operation){const t=qt(e.entityName);return{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation,valueKey:t.fields.find((e=>e.primary)).name,textKey:t.fields.find((e=>e.defaultField)).name}}if("contains"===e.operation)return{type:"text",name:e.name,label:e.label}},async loadCache(e){const t=Be();return await t.loadDictionary(e.entityName),t.data[e.entityName]},getPropertyDefinition(e,t){const{navigationKey:a,name:n,primaryKey:l,ownerKey:i,dictionaryKey:o}=e.junction;return{children:[{navigationKey:a,entityName:n,primaryKey:l,foreingKey:i,keys:[l,i,o]}]}},getEntityValue(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.junction.dictionaryKey;return t[a].map((e=>e[n]))},getTextValueFromEntity:_e,getCsvValueFromEntity:_e};function qe(e){const t=je(e,e.form);return(0,o.useEntity)(t)}function Re(e){const t=m();return(0,o.entitySave)(e,me,{Authorization:t.jwt})}function Ue(e){const t=m();return(0,o.entityDelete)(e,me,{Authorization:t.jwt})}function je(e,{navigationKey:t=null,children:a=[],foreingKey:n=null,detailFields:l=[]}){const i={navigationKey:t,entityName:e.name||e.entityName,primaryKey:e.fields.find((e=>e.primary)).name,foreingKey:n,keys:null,dateKeys:null,children:null,details:null};for(const e of a){const t=qt(e.listName);i.children=Ke(i.children,[je(t,e)])}for(const t of e.fields){const{getPropertyDefinition:e}=ht[t.type]||{};if("function"==typeof e){const a=e(t,!0===l||l?.includes(t.name));i.keys=Me(i.keys,a.keys),i.ignoredKeys=Me(i.ignoredKeys,a.ignoredKeys),i.dateKeys=Me(i.dateKeys,a.dateKeys),i.children=Ke(i.children,a.children),i.details=Ke(i.details,a.details)}}return i}function Pe(e,...t){for(const a of t)Me(e.keys,a.keys),Me(e.dateKeys,a.dateKeys),Ke(e.children,a.children),Ke(e.details,a.details);return e}function Me(e,t){if(Le(e)&&Le(t))for(const a of t)e.includes(a)||e.push(a);else if(!Le(e)&&Le(t))return t;return e}function Ke(e,t){if(Le(e)&&Le(t)){const a=[...t];for(const t of e){const e=a.findIndex((e=>t.navigationKey==e.navigationKey&&t.entityName===e.entityName&&t.primaryKey===e.primaryKey&&t.foreingKey===e.foreingKey));if(e>=0){const[n]=a.splice(e,1);Pe(t,n)}}e.push(...a)}else if(!Le(e)&&Le(t))return t;return e}function Le(e){return Array.isArray(e)&&e.length>0}function ze(e,t){const{navigationKey:a,name:n,nameKey:l}=e.entity;return t[a||n]?.[l]??""}const Ge={detailsCell:X,formField:{__name:"form-field-file-multi",props:{label:{type:String,default:void 0},disabled:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},maxFiles:{type:Number,default:void 0},modelValue:{type:Array,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},entityName:{type:String,default:void 0},navigationKey:{type:String,default:void 0},primaryKey:{type:String,default:void 0},foreingKey:{type:String,default:void 0},nameKey:{type:String,default:void 0},contentKey:{type:String,default:void 0},typeKey:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=ue();function i(e){const t=new FileReader;t.addEventListener("load",(t=>{const n=a.entityName??a.field.entity?.name,l=a.navigationKey??a.field.entity?.navigationKey,i=a.nameKey??a.field.entity?.nameKey,o=a.contentKey??a.field.entity?.contentKey,r=a.typeKey??a.field.entity?.typeKey;a.entity[l??n].add({[i]:e.name,[r]:e.type,[o]:t.target.result.replace(/^.+,/,"")})})),t.addEventListener("error",(()=>l.alert({title:"Error",message:"Error al llegir el arxiu."}))),t.readAsDataURL(e)}function r(e){const t=a.entityName??a.field.entity?.name,n=a.navigationKey??a.field.entity?.navigationKey;a.entity[n??t].delete(e)}const d=(0,n.computed)((()=>{const e=a.entityName??a.field.entity?.name,t=a.navigationKey??a.field.entity?.navigationKey,n=a.primaryKey??a.field.entity?.primaryKey,l=a.nameKey??a.field.entity?.nameKey,i=a.contentKey??a.field.entity?.contentKey,r=a.typeKey??a.field.entity?.typeKey;return(0,o.entityData)(a.entity[t??e]).map((t=>[t[l],async()=>{if(!t[i]){const a=await xe(`${e}(${t[n]})`,{$select:i});t[i]=a[i]}return`data:application/octet-stream;base64,${t[i]}`},t[r]]))}));return(a,l)=>{const o=(0,n.resolveComponent)("fura-file-multi");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,disabled:e.disabled??e.field.disabled,required:e.required??e.field.required,readonly:e.readonly??e.field.readonly,"max-files":e.maxFiles??e.field.maxFiles,"model-value":(0,n.unref)(d),onLoad:i,onDelete:r,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","disabled","required","readonly","max-files","model-value"])}}},getDetailsODataQuery(e){const{name:t,navigationKey:a,primaryKey:n,foreingKey:l,nameKey:i,contentKey:o,typeKey:r}=e.entity;return{$expand:`${a||t}($select=${n},${l},${i},${o},${r})`}},getOrderbySentence:e=>null,getFilterCondition(e){if("has"===e.operation)return`(${e.entity.navigationKey||e.entity.name}/$count ne 0) eq @${e.name}`},getFilterInterface(e){if("has"===e.operation)return{type:"checkbox",name:e.name,label:e.label}},getPropertyDefinition(e,t){const{name:a,navigationKey:n,primaryKey:l,foreingKey:i,nameKey:o,contentKey:r,typeKey:d}=e.entity;return{children:[{navigationKey:n,entityName:a,primaryKey:l,foreingKey:i,keys:[l,i,o,r,d],ignoredKeys:[r]}]}},getTextValueFromEntity:ze,getCsvValueFromEntity:ze},We=["value"];function Ze(e,t){return t[e.name]??""}const He={detailsCell:X,formField:{__name:"form-field-hidden",props:{name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","focus","blur"],setup(e){const t=e,a=t.name||t.field.name,l=(0,n.computed)((()=>t.entity[a]));return t.validations.createField(a,l),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("input",{type:"hidden",value:String((0,n.unref)(l))},null,8,We))}},getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition(e){},getFilterInterface(e){},getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"string"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:Ze,getCsvValueFromEntity:Ze},Xe={__name:"form-field-lookup",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},navigationKey:{type:String,default:void 0},entityName:{type:String,default:void 0},primaryKey:{type:String,default:void 0},targetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=m(),i=ue(),r=(0,n.computed)((()=>a.entityName??a.field.entity.name)),d=(0,n.computed)((()=>a.primaryKey??a.field.entity.primaryKey)),u=(0,n.computed)((()=>a.targetKey??a.field.entity.targetKey)),{options:s,isLoading:c}=(0,o.useOptionsLoader)(me,r,d,u,{$filter:(0,n.computed)((()=>a.filter??a.field.filter))},{Authorization:l.jwt});function p(e){const n=a.name??a.field.name,l=(a.navigationKey??a.field.entity.navigationKey)||r.value,i=s.value.find((t=>t.value===e))?.text;t("change",(t=>{t[n]=e,t[l]={[u.value]:i}}))}return(0,n.watch)(c,(e=>e&&r.value?i.loadStart(`list/${r.value}/load`):i.loadEnd(`list/${r.value}/load`)),{immediate:!0}),(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(s),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":p,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},Ye={__name:"grid-field-lookup",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},navigationKey:{type:String,default:void 0},entityName:{type:String,default:void 0},primaryKey:{type:String,default:void 0},targetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Xe),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};function Qe(e,t){const{navigationKey:a,name:n,targetKey:l}=e.entity;return t[a||n]?.[l]??""}const Je={detailsCell:X,formField:Xe,gridField:(0,f.Z)(Ye,[["__scopeId","data-v-543d71e4"]]),getDetailsODataQuery(e){const t=e.entity.navigationKey||e.entity.name;return{$select:e.name,$expand:`${t}($select=${e.entity.targetKey})`}},getOrderbySentence:e=>`${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}`,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"in"===e.operation?`${e.name} in @${e.name}`:"contains"===e.operation?`contains(${e.entity.navigationKey||e.entity.name}/${e.entity.targetKey}, @${e.name})`:void 0,getFilterInterface:e=>"eq"===e.operation?{type:"combo",name:e.name,label:e.label,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"in"===e.operation?{type:"combo",name:e.name,label:e.label,multiple:!0,valueKey:e.entity.primaryKey,textKey:e.entity.targetKey}:"contains"===e.operation?{type:"text",name:e.name,label:e.label}:void 0,getPropertyDefinition:(e,t=!1)=>({keys:[e.name],details:t?[{navigationKey:e.entity.navigationKey,entityName:e.entity.name,keys:[e.entity.targetKey]}]:null}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):null!=e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:Qe,getCsvValueFromEntity:Qe},et=(0,l.defineStore)({id:"listCache",state:()=>({contextName:null,data:{}}),actions:{setContextName(e){const t=(0,n.toRaw)(e);this.contextName!==t&&(this.contextName=t,this.data={})},async load(e,{force:t=!1}={}){const a=(0,n.toRaw)(e);if(t||!(a in this.data)){const e=qt(a);if(e){this.data[a]={};const t=[];for(const a of e.fields)ht[a.type]?.loadCache&&t.push({name:a.name,promise:ht[a.type].loadCache(a,e.fields)});const n=await Promise.all(t.map((e=>e.promise)));for(let e=0;e<n.length;e+=1){const l=t[e].name;this.data[a][l]=n[e]}}}},async reloadField(e,t){const a=(0,n.toRaw)(e);if(this.data[a]){const e=qt(a);if(e){const l=e.fields.find((e=>e.name===(0,n.toRaw)(t)));if(l){const t=ht[l.type];t&&t.loadCache&&(this.data[a][l.name]=await t.loadCache(l,e.fields))}}}}}}),tt={__name:"form-field-lookup-cache",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=et(),i=(0,n.computed)((()=>l.data[a.cacheName]?.[a.field.name]||[])),{filteredData:o}=ke(a,i),r=(0,n.computed)((()=>a.field.entity.primaryKey)),d=(0,n.computed)((()=>a.field.entity.targetKey)),u=(0,n.computed)((()=>o.value.map((e=>({value:e[r.value],text:e[d.value]})))));function s(e){const n=a.name??a.field.name,l=a.field.entity.navigationKey||a.field.entity.name,i=u.value.find((t=>t.value===e))?.text;t("change",(t=>{t[n]=e,t[l]={[d.value]:i}}))}return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,options:(0,n.unref)(u),"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":s,onFocus:l[0]||(l[0]=e=>t("focus",e)),onBlur:l[1]||(l[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","options","model-value"])}}},at={__name:"grid-field-lookup-cache",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},createField:{type:Function,default:void 0},modelValue:{type:void 0,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(tt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},nt=(0,f.Z)(at,[["__scopeId","data-v-bccf8768"]]),lt={...Je,formField:tt,gridField:nt,loadCache:async e=>(await xe(e.entity.name,{$select:[e.entity.primaryKey,e.entity.targetKey,...e.entity.cache||[]],$orderby:e.entity.targetKey})).value},it={__name:"form-field-lookup-multi",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=(0,n.shallowRef)([]);(0,n.watchEffect)((async()=>{const e=a.dataEntityName??a.field.data?.name,t=a.dataPrimaryKey??a.field.data?.primaryKey,n=a.dataTargetKey??a.field.data?.targetKey,i=a.filter??a.field.data.filter,o=await xe(e,{$select:`${t},${n}`,$filter:i||void 0,$orderby:`${n} asc`});l.value=o.value.map((e=>({value:e[t],text:e[n]})))}));const i=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),r=(0,n.computed)({get(){const e=a.junctionTargetKey??a.field.junction.targetKey;return(0,o.entityData)(a.entity[i.value]).map((t=>t[e]))},set(e){const n=a.junctionTargetKey??a.field.junction.targetKey;t("change",(t=>{const a=t[i.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(o,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(l),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(r),"onUpdate:modelValue":i[0]||(i[0]=e=>(0,n.isRef)(r)?r.value=e:null),onFocus:i[1]||(i[1]=e=>t("focus",e)),onBlur:i[2]||(i[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},ot={__name:"grid-field-lookup-multi",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},filter:{type:String,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(it),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}};function rt(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.data.navigationKey||e.data.name,l=e.data.targetKey;return t[a]?.map((e=>e[n][l])).join(", ")??""}const dt={detailsCell:X,formField:it,gridField:(0,f.Z)(ot,[["__scopeId","data-v-683903ff"]]),getDetailsODataQuery:e=>({$expand:`${e.junction.navigationKey||e.junction.name}($expand=${e.data.navigationKey||e.data.name}($select=${e.data.primaryKey},${e.data.targetKey};$orderby=${e.data.targetKey}))`}),getOrderbySentence:e=>null,getFilterCondition(e){const t=e.junction.navigationKey||e.junction.name;return"in"===e.operation?`${t}/any(o: o/${e.junction.targetKey} in @${e.name})`:"contains"===e.operation?`contains(${t}/${e.entity.targetKey}, @${e.name})`:void 0},getFilterInterface:e=>"in"===e.operation?{type:"combo",name:e.name,label:e.label,multiple:"in"===e.operation,valueKey:e.data.primaryKey,textKey:e.data.targetKey}:"contains"===e.operation?{type:"text",name:e.name,label:e.label}:void 0,getPropertyDefinition(e,t){const{navigationKey:a,name:n,primaryKey:l,ownerKey:i,targetKey:o}=e.junction;return{children:[{navigationKey:a,entityName:n,primaryKey:l,foreingKey:i,keys:[l,i,o]}]}},getEntityValue(e,t){const a=e.junction.navigationKey||e.junction.name,n=e.junction.targetKey;return t[a].map((e=>e[n]))},getTextValueFromEntity:rt,getCsvValueFromEntity:rt},ut={__name:"form-field-lookup-multi-cache",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=et(),i=(0,n.computed)((()=>l.data[a.cacheName]?.[a.field.name]||[])),{filteredData:r}=ke(a,i),d=(0,n.computed)((()=>a.field.data.primaryKey)),u=(0,n.computed)((()=>a.field.data.targetKey)),s=(0,n.computed)((()=>r.value.map((e=>({value:e[d.value],text:e[u.value]}))))),c=(0,n.computed)((()=>{const e=a.junctionNavigationKey??a.field.junction.navigationKey,t=a.junctionEntityName??a.field.junction.name;return e||t})),m=(0,n.computed)({get(){const e=a.junctionTargetKey??a.field.junction.targetKey;return(0,o.entityData)(a.entity[c.value]).map((t=>t[e]))},set(e){const n=a.junctionTargetKey??a.field.junction.targetKey;t("change",(t=>{const a=t[c.value];for(let t=a.length-1;t>=0;t-=1)e.includes(a[t][n])||a.delete(t);for(const t of e){const e=a.some((e=>e[n]===t));e||a.add({[n]:t})}}))}});return(a,l)=>{const i=(0,n.resolveComponent)("llesca-field-combo");return(0,n.openBlock)(),(0,n.createBlock)(i,{multiple:"",label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,readonly:e.readonly??e.field.readonly,"allow-freeform":e.allowFreeform??e.field.allowFreeform,"auto-complete":e.autoComplete??e.field.autoComplete,"accent-insensitive":e.accentInsensitive??e.field.accentInsensitive,placeholder:e.placeholder??e.field.placeholder,"immediate-scroll":e.immediateScroll??e.field.immediateScroll,"max-selected-options":e.maxSelectedOptions??e.field.maxSelectedOptions,options:(0,n.unref)(s),"create-field":e.validations?.createField,name:e.name??e.field.name,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,modelValue:(0,n.unref)(m),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,n.isRef)(m)?m.value=e:null),onFocus:l[1]||(l[1]=e=>t("focus",e)),onBlur:l[2]||(l[2]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","readonly","allow-freeform","auto-complete","accent-insensitive","placeholder","immediate-scroll","max-selected-options","options","create-field","name","required","disabled","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","modelValue"])}}},st={__name:"grid-field-lookup-multi-cache",props:{invalid:{type:Boolean,default:void 0},readonly:{type:Boolean,default:void 0},multiple:{type:Boolean,default:void 0},allowFreeform:{type:Boolean,default:void 0},autoComplete:{type:Boolean,default:void 0},accentInsensitive:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},immediateScroll:{type:Boolean,default:void 0},maxSelectedOptions:{type:Number,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0},junctionEntityName:{type:String,default:void 0},junctionNavigationKey:{type:String,default:void 0},junctionOwnerKey:{type:String,default:void 0},junctionTargetKey:{type:String,default:void 0},dataEntityName:{type:String,default:void 0},dataPrimaryKey:{type:String,default:void 0},dataTargetKey:{type:String,default:void 0},cacheName:{type:String,default:void 0},filter:{type:Function,default:void 0},useFilter:{type:Function,default:void 0}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ut),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},ct=(0,f.Z)(st,[["__scopeId","data-v-754a3117"]]),mt={...dt,formField:ut,gridField:ct,loadCache:async e=>(await xe(e.data.name,{$select:[e.data.primaryKey,e.data.targetKey,...e.data.cache||[]],$orderby:e.data.targetKey})).value},pt={__name:"form-field-number",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},formatStyle:{type:String,default:void 0},useGrouping:{type:Boolean,default:void 0},minimumIntegerDigits:{type:Number,default:void 0},minimumFractionDigits:{type:Number,default:void 0},maximumFractionDigits:{type:Number,default:void 0},minimumSignificantDigits:{type:Number,default:void 0},maximumSignificantDigits:{type:Number,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},align:{type:String,default:void 0},alignFocus:{type:String,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Number,default:void 0},max:{type:Number,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur"],setup(e,{emit:t}){const a=e;function l(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-number");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,placeholder:e.placeholder??e.field.placeholder,prefix:e.prefix??e.field.prefix,suffix:e.suffix??e.field.suffix,multiline:e.multiline??e.field.multiline,icon:e.icon??e.field.icon,readonly:e.readonly??e.field.readonly,maxlength:e.maxlength??e.field.maxlength,unresizable:e.unresizable??e.field.unresizable,"auto-adjust-height":e.autoAdjustHeight??e.field.autoAdjustHeight,"format-style":e.formatStyle??e.field.formatStyle,"use-grouping":e.useGrouping??e.field.useGrouping,"minimum-integer-digits":e.minimumIntegerDigits??e.field.minimumIntegerDigits,"minimum-fraction-digits":e.minimumFractionDigits??e.field.minimumFractionDigits,"maximum-fraction-digits":e.maximumFractionDigits??e.field.maximumFractionDigits,"minimum-significant-digits":e.minimumSignificantDigits??e.field.minimumSignificantDigits,"maximum-significant-digits":e.maximumSignificantDigits??e.field.maximumSignificantDigits,parse:e.parse??e.field.parse,stringify:e.stringify??e.field.stringify,"stringify-focus":e.stringifyFocus??e.field.stringifyFocus,align:e.align??e.field.align,"align-focus":e.alignFocus??e.field.alignFocus,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,min:e.min??e.field.min,max:e.max??e.field.max,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":l,onFocus:i[0]||(i[0]=e=>t("focus",e)),onBlur:i[1]||(i[1]=e=>t("blur",e))},null,8,["label","description","invalid","borderless","underlined","placeholder","prefix","suffix","multiline","icon","readonly","maxlength","unresizable","auto-adjust-height","format-style","use-grouping","minimum-integer-digits","minimum-fraction-digits","maximum-fraction-digits","minimum-significant-digits","maximum-significant-digits","parse","stringify","stringify-focus","align","align-focus","required","disabled","min","max","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},ft={__name:"grid-field-number",props:{invalid:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},formatStyle:{type:String,default:void 0},useGrouping:{type:Boolean,default:void 0},minimumIntegerDigits:{type:Number,default:void 0},minimumFractionDigits:{type:Number,default:void 0},maximumFractionDigits:{type:Number,default:void 0},minimumSignificantDigits:{type:Number,default:void 0},maximumSignificantDigits:{type:Number,default:void 0},parse:{type:Function,default:void 0},stringify:{type:Function,default:void 0},stringifyFocus:{type:Function,default:void 0},align:{type:String,default:void 0},alignFocus:{type:String,default:void 0},createField:{type:Function,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},min:{type:Number,default:void 0},max:{type:Number,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(pt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onClick:r[1]||(r[1]=e=>t("click",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o)}),null,16,["borderless","onFocus","onBlur"]))}},yt={detailsCell:X,formField:pt,gridField:(0,f.Z)(ft,[["__scopeId","data-v-794c5b06"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"between"===e.operation?new W([`${e.name} gt @${e.name}_gt`,`${e.name} lt @${e.name}_lt`],"and"):void 0,getFilterInterface:e=>"eq"===e.operation?{type:"number",name:e.name,label:e.label}:"between"===e.operation?[{type:"number",name:`${e.name}_gt`,label:`${e.label} Menor`},{type:"number",name:`${e.name}_lt`,label:`${e.label} Major`}]:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"number"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity(e,t){const a=t[e.name];if(null==a||isNaN(a))return"";const n={style:e.formatStyle,currency:"EUR",useGrouping:e.useGrouping,minimumIntegerDigits:e.minimumIntegerDigits,minimumFractionDigits:e.minimumFractionDigits,maximumFractionDigits:e.maximumFractionDigits};return e.minimumSignificantDigits>0&&e.minimumSignificantDigits<22&&(n.minimumSignificantDigits=e.minimumSignificantDigits),e.maximumSignificantDigits>0&&e.maximumSignificantDigits<22&&(n.maximumSignificantDigits=e.maximumSignificantDigits),("percent"===e.formatStyle?a/100:a).toLocaleString("ca-ES",n)},getCsvValueFromEntity(e,t){const a=t[e.name];return null==a||isNaN(a)?"":String(a)}},vt={__name:"form-field-string",props:{label:{type:String,default:void 0},description:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},underlined:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},password:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},pattern:{type:RegExp,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur","keydown"],setup(e,{emit:t}){const a=e;function l(e){const n=a.name??a.field.name;t("change",(t=>{t[n]=e}))}return(a,i)=>{const o=(0,n.resolveComponent)("llesca-field-text");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.label??e.field.label,description:e.description??e.field.description,invalid:e.invalid??e.field.invalid,borderless:e.borderless??e.field.borderless,underlined:e.underlined??e.field.underlined,placeholder:e.placeholder??e.field.placeholder,prefix:e.prefix??e.field.prefix,suffix:e.suffix??e.field.suffix,multiline:e.multiline??e.field.multiline,icon:e.icon??e.field.icon,readonly:e.readonly??e.field.readonly,unresizable:e.unresizable??e.field.unresizable,"auto-adjust-height":e.autoAdjustHeight??e.field.autoAdjustHeight,password:e.password??e.field.password,required:e.required??e.field.required,disabled:e.disabled??e.field.disabled,maxlength:e.maxlength??e.field.maxlength,pattern:e.pattern??e.field.pattern,rules:e.rules??e.field.rules,"auto-validate":e.autoValidate??e.field.autoValidate,"auto-validate-wait":e.autoValidateWait??e.field.autoValidateWait,"clear-value-on-disabled":e.clearValueOnDisabled??e.field.clearValueOnDisabled,name:e.name??e.field.name,"create-field":e.validations?.createField,"model-value":e.entity[e.name??e.field.name],"onUpdate:modelValue":l,onClick:i[0]||(i[0]=e=>t("click")),onFocus:i[1]||(i[1]=e=>t("focus",e)),onBlur:i[2]||(i[2]=e=>t("blur",e)),onKeydown:i[3]||(i[3]=e=>t("keydown",e))},null,8,["label","description","invalid","borderless","underlined","placeholder","prefix","suffix","multiline","icon","readonly","unresizable","auto-adjust-height","password","required","disabled","maxlength","pattern","rules","auto-validate","auto-validate-wait","clear-value-on-disabled","name","create-field","model-value"])}}},gt={__name:"grid-field-string",props:{invalid:{type:Boolean,default:void 0},placeholder:{type:String,default:void 0},prefix:{type:String,default:void 0},suffix:{type:String,default:void 0},multiline:{type:Boolean,default:void 0},icon:{type:String,default:void 0},readonly:{type:Boolean,default:void 0},unresizable:{type:Boolean,default:void 0},autoAdjustHeight:{type:Boolean,default:void 0},password:{type:Boolean,default:void 0},required:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},maxlength:{type:Number,default:void 0},pattern:{type:RegExp,default:void 0},rules:{type:Array,default:void 0},autoValidate:{type:String,default:void 0},autoValidateWait:{type:Number,default:void 0},clearValueOnDisabled:{type:Boolean,default:void 0},name:{type:String,default:void 0},entity:{type:Object,required:!0},field:{type:Object,default:void 0},validations:{type:Object,default:void 0}},emits:["change","click","focus","blur","keydown"],setup(e,{emit:t}){const a=e,{borderless:l,handleFocus:i,handleBlur:o}=ee({$emit:t});return(e,r)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(vt),(0,n.mergeProps)(a,{class:"field",label:"",borderless:(0,n.unref)(l),description:null,underlined:!1,onChange:r[0]||(r[0]=e=>t("change",e)),onClick:r[1]||(r[1]=e=>t("click",e)),onFocus:(0,n.unref)(i),onBlur:(0,n.unref)(o),onKeydown:r[2]||(r[2]=e=>t("keydown",e))}),null,16,["borderless","onFocus","onBlur"]))}};function bt(e,t){return t[e.name]??""}const ht={boolean:C,childCount:Q,choice:ne,date:de,dictionary:De,dictionaryMulti:Fe,fileMulti:Ge,lookup:Je,hidden:He,lookupCache:lt,lookupMulti:dt,lookupMultiCache:mt,number:yt,string:{detailsCell:X,formField:vt,gridField:(0,f.Z)(gt,[["__scopeId","data-v-1878bbd0"]]),getDetailsODataQuery:e=>({$select:e.name}),getOrderbySentence:e=>e.name,getFilterCondition:e=>"eq"===e.operation?`${e.name} eq @${e.name}`:"contains"===e.operation?`contains(${e.name}, @${e.name})`:"in"===e.operation?`${e.name} in @${e.name}`:void 0,getFilterInterface:e=>["eq","contains"].includes(e.operation)?{type:"text",name:e.name,label:e.label}:"in"===e.operation?{type:"csv",name:e.name,label:e.label}:void 0,getPropertyDefinition:(e,t)=>({keys:[e.name]}),setDetaultValueToEntity(e,t,{notOverwrite:a}={}){void 0===e.defaultValue||a&&null!=t[e.name]||("function"==typeof e.defaultValue?t[e.name]=e.defaultValue(t):"string"==typeof e.defaultValue&&(t[e.name]=e.defaultValue))},getEntityValue:(e,t)=>t[e.name],getTextValueFromEntity:bt,getCsvValueFromEntity:bt}},Ct={__name:"form-field-collection",props:{fields:{type:Array,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0},withClass:{type:[Boolean,Function],default:null},withAreaName:{type:[Boolean,Function],default:null},cacheName:{type:String,default:""}},emits:["change","focus","blur"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>a.fields.filter((e=>!e.primary&&e.type))));function i(e){return!0===a.withClass?`formField-${e.name}`:"function"==typeof a.withClass?a.withClass.call(null,e):void 0}function o(e){return!0===a.withAreaName?{gridArea:e.name}:"function"==typeof a.withAreaName?{gridArea:a.withAreaName.call(null,e)}:void 0}return(r,d)=>((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(l),(l=>((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(ht)[l.type].formField),{key:l.name,entity:e.entity,field:l,validations:e.validations,class:(0,n.normalizeClass)(i(l)),style:(0,n.normalizeStyle)(o(l)),"cache-name":e.cacheName,onChange:e=>async function(e,n){if(t("change",{field:e,action:n}),"function"==typeof e.onChange){const n=await e.onChange(a.entity);"function"==typeof n&&t("change",{field:e,action:n})}}(l,e),onFocus:e=>async function(e,n){if("function"==typeof e.onFocus){const l=await e.onFocus(a.entity,n);"function"==typeof l&&t("change",{field:e,action:l})}}(l,e),onBlur:e=>async function(e,n){if("function"==typeof e.onBlur){const l=await e.onBlur(a.entity,n);"function"==typeof l&&t("change",{field:e,action:l})}}(l,e)},null,40,["entity","field","validations","class","style","cache-name","onChange","onFocus","onBlur"])))),128))}},xt={class:"CAMP_COMU-edit-layout"},wt={__name:"form-camp-comu",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e;et().load("CAMP_COMU");const a=qt("CAMP_COMU"),l=(0,n.computed)((()=>Rt(a,["LITERAL","ID_SECCIO","ORDRE","REQUIRED","ID_TIPUSCAMP",{name:"ID_DICCIONARI",required:8===t.entity.ID_TIPUSCAMP,disabled:8!==t.entity.ID_TIPUSCAMP,clearValueOnDisabled:!0},{name:"LONGITUD",required:1===t.entity.ID_TIPUSCAMP,disabled:1!==t.entity.ID_TIPUSCAMP,clearValueOnDisabled:!0},{name:"MULTISELECCIO",disabled:t.entity.ID_TIPUSCAMP<7,clearValueOnDisabled:!0},"TAGXML",{name:"TAGXML_TEXT",required:8===t.entity.ID_TIPUSCAMP,disabled:8!==t.entity.ID_TIPUSCAMP,clearValueOnDisabled:!0},{name:"LLISTA_VALORS",required:7===t.entity.ID_TIPUSCAMP,disabled:7!==t.entity.ID_TIPUSCAMP}])));return(t,a)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",xt,[(0,n.createVNode)((0,n.unref)(Ct),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":"CAMP_COMU",onChange:a[0]||(a[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations"])]))}},Nt=(0,f.Z)(wt,[["__scopeId","data-v-32c7ddcc"]]),Vt={name:"CAMP_COMU",type:"listSplitted",label:"Camps comuns",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"LITERAL",label:"Etiqueta camp",type:"string",required:!0,maxlength:120},{name:"ID_SECCIO",label:"Secció",type:"lookupCache",dataType:"number",required:!0,clearValueOnDisabled:!0,entity:{name:"SECCIO",primaryKey:"ID",targetKey:"ORDREINOM"}},{name:"ORDRE",label:"Ordre dins la secció",type:"number",decimals:0,min:1,max:1e3,maxlength:4},{name:"ID_TIPUSCAMP",label:"Tipus de camp",type:"lookupCache",dataType:"number",required:!0,clearValueOnDisabled:!0,entity:{name:"TIPUSCAMP",primaryKey:"ID",targetKey:"NOM_TIPUSCAMP"}},{name:"LONGITUD",label:"Longitud",type:"number",decimals:0,min:1,max:1e3,maxlength:4},{name:"REQUIRED",label:"Obligatori",type:"boolean"},{name:"STATICVALUE",label:"Valor fix",type:"string",maxlength:40},{name:"MERGEPLANTILLA",label:"Merge plantilla",type:"string",maxlength:120},{name:"TAGXML",label:"Path",type:"string",required:!0,maxlength:512},{name:"TAGXML_TEXT",label:"Path (text lookup)",type:"string",maxlength:512},{name:"LLISTA_VALORS",label:"Valors de la llista valors (camps Llista de valors)",type:"string",maxlength:8e3},{name:"MULTISELECCIO",label:"Multi selecció",type:"boolean"},{name:"ID_DICCIONARI",label:"Diccionari",type:"lookupCache",dataType:"number",required:!0,clearValueOnDisabled:!0,entity:{name:"DICCIONARI",primaryKey:"ID",targetKey:"NOM_DICCIONARI"}},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"ID_SECCIO",operation:"eq"},{name:"ID_TIPUSCAMP",operation:"eq"},{name:"LITERAL",operation:"contains"},{name:"ID_DICCIONARI",operation:"eq"}],form:{entityName:"CAMP_COMU",component:(0,n.markRaw)(Nt)}},It={name:"CONTROLACCES",type:"dictionary",label:"Controls d'accès",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Control d'accès",type:"string",defaultProperty:!0,required:!0,maxlength:40}]},St={tipusDocument:[{value:"act",text:"Acta"},{value:"aco",text:"Acord"},{value:"alb",text:"Albarà"},{value:"ale",text:"Al·legació"},{value:"cer",text:"Certificat"},{value:"cit",text:"Citació"},{value:"com",text:"Comunicat"},{value:"con",text:"Conveni"}],nivellSeguretat:[{value:"public",text:"public"},{value:"intern",text:"intern"},{value:"restringit",text:"restringit"},{value:"confidencial",text:"confidencial"}],sensibilitatLopd:[{value:"basic",text:"basic"},{value:"mig",text:"mig"},{value:"alt",text:"alt"}],classEvidencial:[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"}],rol:[{value:"Administrador",text:"Administrador"},{value:"Usuari",text:"Usuari"}]},Bt=[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"CODI_TRAMIT",label:"Codi tràmit",type:"string",required:!0,maxlength:16,loadAlwaysInView:!0},{name:"CODI_MODALITAT",label:"Modalitat",type:"string",required:!0,maxlength:4,loadAlwaysInView:!0},{name:"VARIANT_TRAMIT",label:"Variant",type:"number",required:!0,decimals:0,align:"right",maxlength:4},{name:"NOM_TRAMIT",label:"Nom del tràmit",type:"string",required:!0,maxlength:80},{name:"NOM_PROCEDIMENT",label:"Nom procediment",type:"string",maxlength:80},{name:"VERSIONEGOCI",label:"Versió negoci",type:"string",disabled:!0,maxlength:8},{name:"UNITATGESTORA",label:"Unitat gestora",required:!0,maxlength:80},{name:"DESTI",label:"Id. destí",required:!0,maxlength:8},{name:"ID_TIPUSUSUARI_REQUERIDOR",label:"Tipus sol·licitant",type:"lookupCache",dataType:"number",required:!0,entity:{name:"TIPUSUSUARI",primaryKey:"ID",targetKey:"TEXT"}},{name:"ID_TIPUSUSUARI_PRESENTADOR",label:"Tipus presentador",type:"lookupCache",dataType:"number",entity:{name:"TIPUSUSUARI",primaryKey:"ID",targetKey:"TEXT"}},{name:"TIPUSDOCUMENT",label:"Tipus document",type:"choice",dataType:"string",options:St.tipusDocument,required:!0,maxlength:8},{name:"SENSIBILITATLOPD",label:"Sensibilitat LOPD",type:"choice",dataType:"string",options:St.sensibilitatLopd,required:!0,maxlength:8},{name:"NIVELLSEGURETAT",label:"Nivell seguretat",type:"choice",dataType:"string",options:St.nivellSeguretat,required:!0,maxlength:8},{name:"CLASS_EVIDENCIAL",label:"Clas. evidencial",type:"choice",dataType:"string",options:St.classEvidencial,required:!0,maxlength:8},{name:"DADES_INTERESSATS",label:"Dades altres interessats (mare)",type:"boolean"},{name:"DADES_INTERESSATS2",label:"Dades altres interessats (2)",type:"boolean",clearValueOnDisabled:!0},{name:"DADES_CENTRE",label:"Dades del Centre",type:"boolean"},{name:"INCLOURE_IDLLISTES",label:"incloure (ID) llistes desplegables Excel",type:"boolean"},{name:"CODIINOM",label:"Codi i nom tràmit",type:"string",readonly:!0},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],kt={class:"TRAMIT-edit-layout"},Et={__name:"form-tramit",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){et().load("TRAMIT");const t=Rt(qt("TRAMIT"),["CODI_TRAMIT","CODI_MODALITAT","VARIANT_TRAMIT","NOM_TRAMIT","VERSIONEGOCI","NOM_PROCEDIMENT","DESTI","UNITATGESTORA","TIPUSDOCUMENT","NIVELLSEGURETAT","CLASS_EVIDENCIAL","SENSIBILITATLOPD","ID_TIPUSUSUARI_REQUERIDOR","ID_TIPUSUSUARI_PRESENTADOR","INCLOURE_IDLLISTES","DADES_INTERESSATS","DADES_INTERESSATS2","DADES_CENTRE"]);return(a,l)=>{const i=(0,n.resolveComponent)("fura-label");return(0,n.openBlock)(),(0,n.createElementBlock)("div",kt,[(0,n.createVNode)((0,n.unref)(Ct),{"with-area-name":"",fields:(0,n.unref)(t),entity:e.entity,validations:e.validations,"cache-name":"TRAMIT",onChange:l[0]||(l[0]=e=>a.$emit("change",e.action))},null,8,["fields","entity","validations"]),(0,n.createVNode)(i,{style:{"grid-area":"INCLOURE","margin-top":"12px","font-weight":"800",color:"rgb(0,111,148)"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)("Incloure"))])),_:1}),(0,n.createVNode)(i,{style:{"grid-area":"AVISt","margin-top":"0px","font-weight":"800",color:"rgb(0,111,148)"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)("IMPORTANT"))])),_:1}),(0,n.createVNode)(i,{style:{"grid-area":"AVIS","margin-top":"0px"}},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)("Si es modifica la configuració del tràmit cal carregar de nou l'arxiu de configuració del tràmit."),1)])),_:1})])}}},At=(0,f.Z)(Et,[["__scopeId","data-v-72548644"]]);const Ot={name:"TRAMIT",type:"listSplitted",label:"Tràmits",fields:Bt,filter:[{name:"CODI_TRAMIT",label:"Codi tràmit conté",operation:"contains"},{name:"CODI_MODALITAT",label:"Codi modalitat conté",operation:"contains"},{name:"NOM_TRAMIT",label:"Nom tràmit conté",operation:"contains"},{name:"VARIANT_TRAMIT",operation:"eq"},{name:"NOM_PROCEDIMENT",label:"Nom procediment conté",operation:"contains"}],form:{entityName:"TRAMIT",component:(0,n.markRaw)(At)},menuUpdater:function(e,t){const a=t?[{type:"divider"},{text:"Carrega XML configuració",icon:"FollowUser",action:()=>async function(e){const t=document.getElementById("upload");t&&t.parentNode.removeChild(t);const a=document.createElement("input");a.accept=".xml",a.type="file",a.id="upload",a.style.visibility="hidden",document.body.appendChild(a),a.addEventListener("change",(function(){!async function(e,t){if(t.files.length>0){const a=ue();a.alert({title:"Càrrega arxiu de configuració del tràmit",message:"Executant el procés de l'arxiu de configuració."});const n=new FileReader;n.onload=async function(){const l=n.result.replace(/\r\n/g,"").toString(),i=(new DOMParser).parseFromString(l,"application/xml");i.querySelector("blocPlantilles").remove();const o=(new XMLSerializer).serializeToString(i),r=m(),d=await fetch(`${me}/Stored/st_LOAD_CONFIG?id=${e}`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"text/plain",Authorization:r.jwt},body:o}),u=(await d.json()).output.OUTPUT;a.alertClose(),t.parentNode.removeChild(t),u.error?a.alert({title:"Càrrega configuració",message:`Error al carregar ${u.error}`}):a.alert({title:"Càrrega configuració",message:"Configuració carregada correctament"})},n.readAsText(t.files[0])}}(e,a)}),!1),a.click()}(t.ID)},{text:"Crear variant del tràmit",icon:"Add",action:()=>async function(e){const t=ue();t.alert({title:"Crear variant d'un tràmit",message:"Executant el procés de creació de la variant del tràmit"});const a=m(),n=await fetch(`${me}/Stored/st_CREAR_VARIANT`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:a.jwt},body:JSON.stringify({XML:`<XML ID="${e}" />`})}),l=(await n.json()).output.OUTPUT;t.alertClose(),l.error?t.alert({title:"Crear variant d'un tràmit",message:`Error al crear la variant del tràmit: ${l.error}`}):(t.alert({title:"Crear variant d'un tràmit",message:"Variant creada correctament"}),window.location=window.location.pathname+window.location.search+"&reload=true")}(t.ID)},{text:"Crear plantilla Excel",icon:"ExcelLogo",action:()=>async function(e,t,a){const n=ue();n.alert({title:"Creació plantilla XSLX del tràmit",message:"Executant el procés de creació de la plantilla"});const l=m(),i=await fetch(`${me}/Processos/CrearPlantilla?id=${e}`,{method:"POST",headers:{"Content-Type":"text/plain",Accept:"blob",Authorization:l.jwt}}),o=await i,r=await o.blob();n.alertClose();const d=(window.URL||window.webkitURL).createObjectURL(r),u=document.createElement("a");u.setAttribute("href",d),u.setAttribute("download",`PLANTILLA-${t}-${a}-data-${(new Date).toLocaleDateString().replace(/\//g,"-")}.xlsx`),u.click()}(t.ID,t.CODI_TRAMIT,t.CODI_MODALITAT)},{text:"Generar zip",icon:"Upload",action:()=>async function(e,t,a){const n=document.getElementById("upload");if(n)n.setAttribute("accept",".xlsx");else{const e=document.createElement("input");e.accept=".xlsx",e.type="file",e.id="upload",e.style.visibility="hidden",document.body.appendChild(e)}const l=document.getElementById("upload");l.addEventListener("change",(function(){l.files.length>0&&async function(e,t,a,n){const l=ue();l.alert({title:"Crear ZIP càrrega al tramitador",message:"Executant el procés de creació de l'arxiu ZIP"});const i=new FileReader;i.onload=async function(){const t=i.result,o=m(),r=await fetch(`${me}/Processos/CrearZip?id=${e}`,{method:"POST",headers:{Accept:"text/html, blob","Content-type":"application/octet-stream",Authorization:o.jwt},body:t}),d=await r,u=await d.blob(),s=(window.URL||window.webkitURL).createObjectURL(u);l.alertClose();const c=document.createElement("a");c.setAttribute("href",s),console.log(d),200===d.status?c.setAttribute("download",`DADES-TRAMIT-${a}-${n}-data-${(new Date).toLocaleDateString().replace(/\//g,"-")}.zip`):c.setAttribute("download",`ERRORS-TRAMIT-${a}-${n}-data-${(new Date).toLocaleDateString().replace(/\//g,"-")}.txt`),c.click()},i.readAsArrayBuffer(t.files[0])}(e,l,t,a)}),!1),l.click()}(t.ID,t.CODI_TRAMIT,t.CODI_MODALITAT)}]:[];return e.concat(a)}},Dt={class:"TRAMIT-CAMP-edit-layout"},$t={__name:"form-tramit-camp",props:{entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=qt("TRAMIT_CAMP");et().load("TRAMIT");const l=(0,n.computed)((()=>Rt(a,["ID_TRAMIT","LITERAL","ID_SECCIO","NOM_SECCIO","ORDRE_SECCIO","ORDRE","ID_TIPUSCAMP",{name:"ID_DICCIONARI",required:8===t.entity.ID_TIPUSCAMP,disabled:8!==t.entity.ID_TIPUSCAMP,clearValueOnDisabled:!0},{name:"LONGITUD",required:1===t.entity.ID_TIPUSCAMP,disabled:1!==t.entity.ID_TIPUSCAMP,clearValueOnDisabled:!0},"REQUIRED","MULTISELECCIO","ID_EXCEL","MERGEPLANTILLA","TAGXML",{name:"TAGXML_TEXT",required:8===t.entity.ID_TIPUSCAMP,disabled:8!==t.entity.ID_TIPUSCAMP,clearValueOnDisabled:!0},{name:"LLISTA_VALORS",required:7===t.entity.ID_TIPUSCAMP,disabled:7!==t.entity.ID_TIPUSCAMP}])));return(t,a)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",Dt,[(0,n.createVNode)((0,n.unref)(Ct),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":"TRAMIT_CAMP",onChange:a[0]||(a[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations"])]))}},Tt=(0,f.Z)($t,[["__scopeId","data-v-13662d5a"]]),_t={component:"auto",class:"USUARI-editItem-layout",maxWidth:"900px",fields:e=>["LOGIN_USUARI","COGNOMSINOM_USUARI","ROL","EMAIL_USUARI"],rules:[async e=>await async function(e,t,a,n){const l=qt(e),i=Rt(l,a),o=a.map((function(e){const a=["string","choice"].includes(i.find((t=>t.name===e)).type)?"'":"";return e+" eq "+a+(t[e]||[]).toString().replace(/'/g,"''")+a})).join(" or ");console.log("filter",o);const{"@odata.count":r}=await xe(e,{$filter:"number"==typeof t.ID?`ID ne ${t.ID} and (${o})`:o,$count:!0,$top:0});if(r>0)return console.log("duplicats"),`Hi ha ${l.label} amb valors duplicats`}("USUARI",e,["LOGIN_USUARI","COGNOMSINOM_USUARI","EMAIL_USUARI"])]},Ft=[Vt,It,It,{name:"CONTROLACCES",type:"dictionary",label:"Controls d'accès",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"TITLE",label:"Control d'accès",type:"string",defaultProperty:!0,required:!0,maxlength:40}]},Ot,{name:"TRAMIT_CAMP",type:"listSplitted",label:"Camps del tràmit",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"ID_TRAMIT",label:"Tràmit",type:"lookupCache",dataType:"number",entity:{name:"TRAMIT",primaryKey:"ID",targetKey:"CODIINOM"}},{name:"ID_TIPUSCAMP",label:"Tipus camp",type:"lookupCache",dataType:"number",entity:{name:"TIPUSCAMP",primaryKey:"ID",targetKey:"NOM_TIPUSCAMP"}},{name:"LITERAL",label:"Etiqueta",type:"string",required:!0,maxlength:100},{name:"LONGITUD",label:"Mida del camp",type:"number",decimals:0,required:!0,maxlength:100},{name:"REQUIRED",label:"Obligatori",type:"boolean"},{name:"STATICVALUE",label:"Valor fix",type:"string",maxlength:40},{name:"ORDRE",label:"Ordre camp",type:"number",decimals:0,min:1,max:10,align:"right",maxlength:2},{name:"MERGEPLANTILLA",label:"Merge plantilla",type:"string",maxlength:120},{name:"TAGXML",label:"Path",type:"string",maxlength:512},{name:"TAGXML_TEXT",label:"Path (text lookup)",type:"string",maxlength:512},{name:"ID_SECCIO",label:"Secció",type:"lookupCache",dataType:"number",clearValueOnDisabled:!0,entity:{name:"SECCIO",primaryKey:"ID",targetKey:"NOM_SECCIO"}},{name:"ID_EXCEL",label:"Columna Excel",type:"lookupCache",dataType:"number",clearValueOnDisabled:!0,entity:{name:"EXCEL",primaryKey:"ID",targetKey:"NOM_COLUMNA"}},{name:"NOM_SECCIO",label:"Secció pròpia",type:"string",maxlength:80},{name:"ORDRE_SECCIO",label:"Ordre secció",type:"number",decimals:0,min:1,max:10,align:"right",maxlength:2},{name:"MULTISELECCIO",label:"Multi selecció",type:"boolean"},{name:"LLISTA_VALORS",label:"Llista valors fixa",type:"string",maxlength:8e3},{name:"ID_DICCIONARI",label:"Diccionari",type:"lookupCache",dataType:"number",clearValueOnDisabled:!0,entity:{name:"DICCIONARI",primaryKey:"ID",targetKey:"NOM_DICCIONARI"}},{name:"INCLOURE_IDLLISTES",label:"incloure (ID) llistes desplegables Excel",type:"boolean"},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"ID_TRAMIT",operation:"eq"},{name:"ID_SECCIO",operation:"eq"},{name:"NOM_SECCIO",label:"Secció pròpia del tràmit conté",operation:"contains"},{name:"ID_TIPUSCAMP",operation:"eq"},{name:"LITERAL",label:"Literal conté",operation:"contains"}],form:{entityName:"TRAMIT_CAMP",component:(0,n.markRaw)(Tt)}},{name:"USUARI",type:"listSplitted",label:"Usuaris tramitador",fields:[{name:"ID",type:"number",primary:!0,readonly:!0},{name:"LOGIN_USUARI",label:"Login usuari",type:"string",required:!0,maxlength:16},{name:"COGNOMSINOM_USUARI",label:"Cognoms i nom",type:"string",required:!0,maxlength:80},{name:"EMAIL_USUARI",label:"Email usuari",type:"string",pattern:/^(([^<>()[\].,;:\s@"]+(\.[^<>()[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/,required:!0,maxlength:80},{name:"ROL",label:"Rol",type:"choice",options:St.rol,dataType:"string",required:!0,defaultValue:"Usuari"},{name:"CREATED",type:"date"},{name:"CREATEDBY",type:"string",maxlength:64},{name:"MODIFIED",type:"date"},{name:"MODIFIEDBY",type:"string",maxlength:64}],filter:[{name:"LOGIN_USUARI",operation:"contains"},{name:"COGNOMSINOM_USUARI",operation:"contains"},{name:"EMAIL_USUARI",operation:"contains"},{name:"ROL",operation:"contains"}],form:_t}];function qt(e){return void 0===e?Array.from(Ft):Ft.find((t=>t.name===e))}function Rt(e,t){return t.map((t=>{if("string"==typeof t){const a=e.fields.find((e=>e.name===t));return Object.assign({},a)}{const a=e.fields.find((e=>e.name===t.name));return Object.assign({},a,t)}}))}const Ut={class:"layoutBase-grid"},jt={class:"layoutBase-logo"},Pt=["src"],Mt={class:"layoutBase-title"},Kt={class:"layoutBase-menu"},Lt={class:"layoutBase-content"},zt={__name:"layout-base",props:{subtitle:{type:String,required:!0},hideMenu:{type:Boolean,default:!1}},setup(e){const t=m(),a=t.data.role,l=(0,r.useRouter)();function i(e,t){const a=qt(t);if("list"===e)return{text:a.label,action:()=>l.push(`/${t}`)};if("dictionary"===e){const e=a.fields.find((e=>e.defaultField));return{text:a.label,action:()=>l.push({path:`/${t}`,query:{orderby:`${e.name} asc`}})}}}const o=[{text:"Inici",action:()=>l.push("/")},i("list","TRAMIT"),i("list","TRAMIT_CAMP"),i("list","CAMP_COMU"),{text:"Administració",disabled:"Administrador"!==a,children:[i("list","USUARI")]},{text:t.data.name,children:[{text:"Canviar la clau d'acces",action:()=>l.push("/password-change")},{text:"Tancar sessió",action:()=>{t.setJwt(),l.push("/")}}]}];return(t,a)=>{const l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-command-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Ut,[(0,n.createElementVNode)("div",jt,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(se)}/images/logo.png`,width:"164"},null,8,Pt)]),(0,n.createElementVNode)("div",Mt,[(0,n.createVNode)(l,{class:"layoutBase-appTitle"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(ce)),1)])),_:1}),(0,n.createVNode)(l,{class:"layoutBase-subtitle"},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.subtitle),1)])),_:1})]),(0,n.createElementVNode)("div",Kt,[e.hideMenu?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createBlock)(i,{key:0,"far-items":o}))]),(0,n.createElementVNode)("div",Lt,[(0,n.renderSlot)(t.$slots,"default")])])}}},Gt=(0,f.Z)(zt,[["__scopeId","data-v-c0fde70a"]]);function Wt(e,t=null){return"asc"===(e?.direction??t)?"SortUp":"desc"===(e?.direction??t)?"SortDown":null}function Zt(e){return"string"==typeof e&&e?e.split(",").map((e=>{const[t,a]=e.trim().replace(/\s+/," ").split(" ");return{sentence:t,direction:a||"asc"}})):[]}function Ht(e){return e.filter((e=>["asc","desc"].includes(e.direction))).map((e=>`${e.sentence} ${e.direction}`)).join(",")||void 0}const Xt={__name:"details-view-select",props:{fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},selectedItemId:{type:[Number,String],default:null},autoLayout:{type:String,default:null},compact:{type:Boolean,default:!1},selection:{type:String,default:""},stickyHeader:{type:Boolean,default:!1},stickyHeaderOffset:{type:[String,Number],default:null},pageSize:{type:Number,default:null},currentPage:{type:Number,default:0},dataCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["update:selectedItemId","update:orderby","clickCell","update:currentPage","contextmenuRow","contextmenuCell"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>a.fields.find((e=>e.primary))?.name)),i=(0,n.computed)((()=>{const e=a.data.findIndex((e=>e[l.value]===a.selectedItemId));return e>-1?[e]:[]}));function o(e){if(1===e.length){const n=a.data[e[0]];t("update:selectedItemId",n[l.value])}else t("update:selectedItemId",null)}function r(e){const n=a.data[e.row];t("update:selectedItemId",n[l.value])}const d=(0,n.computed)((()=>a.fields.map(((e,t)=>{if(e.primary)return null;{const n=Ve(e),l=a.orderby.find((e=>e.sentence===n));return{index:t,type:e.type,title:e.label,icon:Wt(l)}}})).filter((e=>e)))),u=(0,n.computed)((()=>{const{pageSize:e,dataCount:t}=a;return"number"==typeof e&&"number"==typeof t})),s=(0,n.computed)((()=>Math.ceil(a.dataCount/a.pageSize)));function c(e){u.value&&e>=0&&e<s.value&&t("update:currentPage",e)}function m(e){const t=Number(e);!isNaN(t)&&t>0&&t<=s.value&&c(t-1)}const p=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"topCenter":case"topRight":return"detailsViewSelect-navTop";case"bottomLeft":case"bottomCenter":case"bottomRight":return"detailsViewSelect-navBottom";default:return}})),f=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"bottomLeft":return"detailsViewSelect-left";case"topCenter":case"bottomCenter":return"detailsViewSelect-center";case"topRight":case"bottomRight":return"detailsViewSelect-right";default:return}}));function y(e){const{index:n}=d.value[e],l=Ve(a.fields[n]);if(l){const n=a.orderby.map((e=>({...e}))),i=n.findIndex((e=>e.sentence===l));if(i>-1){const e=n[i];"asc"===e.direction?e.direction="desc":"desc"===e.direction?a.forcedOrder?e.direction="asc":n.splice(i,1):"none"===e.direction&&(e.direction="asc")}else{const t=n.map((e=>a.fields.findIndex((t=>Ve(t)===e.sentence))));if(t.every((e=>-1===e)))n.push({sentence:l,direction:"asc"});else{const a=[...t.entries()].filter((e=>e[1]>-1)).reduce(((t,a)=>!t||Math.abs(e-a[1])<Math.abs(e-t[1])?a:t),null),i=a[1]<e?a[0]+1:a[0];n.splice(i,0,{sentence:l,direction:"asc"})}}t("update:orderby",n)}}function v({row:e,event:n}){const i=a.data[e][l.value];t("contextmenuCell",{row:e,primary:i,event:n})}function g({row:e,column:n,event:i}){const o=a.data[e][l.value];t("contextmenuCell",{row:e,column:n,primary:o,event:i})}return(t,a)=>{const l=(0,n.resolveComponent)("fura-details-list"),b=(0,n.resolveComponent)("fura-spin-nav");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)((0,n.unref)(p))},[(0,n.createVNode)(l,{columns:(0,n.unref)(d),data:e.data,"selected-indices":(0,n.unref)(i),"auto-layout":e.autoLayout,compact:e.compact,selection:e.selection,"sticky-header":e.stickyHeader,"sticky-header-offset":e.stickyHeaderOffset,"onUpdate:selectedIndices":o,onClickHeader:y,onClickCell:r,onContextmenuRow:v,onContextmenuCell:g},{default:(0,n.withCtx)((a=>[(0,n.renderSlot)(t.$slots,"default",{rowIndex:a.rowIndex,row:e.data[a.rowIndex],fieldIndex:a.column.index,field:e.fields[a.column.index],content:a.content},(()=>[((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(ht)[a.column.type].detailsCell),{field:e.fields[a.column.index],row:e.data[a.rowIndex]},null,8,["field","row"]))]))])),header:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"header",{column:e.column,index:e.index})])),group:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"group",{group:e.group,index:e.index,isCollapsed:e.isCollapsed})])),bodyHeader:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"bodyHeader",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),bodyFooter:(0,n.withCtx)((e=>[(0,n.renderSlot)(t.$slots,"bodyFooter",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),_:3},8,["columns","data","selected-indices","auto-layout","compact","selection","sticky-header","sticky-header-offset"]),(0,n.unref)(u)&&(0,n.unref)(p)&&(0,n.unref)(f)&&e.data.length>0?((0,n.openBlock)(),(0,n.createBlock)(b,{key:0,class:(0,n.normalizeClass)(["detailsViewSelect-navigation",(0,n.unref)(f)]),current:e.currentPage+1,total:(0,n.unref)(s),"end-button":"","start-button":"",editable:"","disable-prev":e.currentPage<=0,"disable-next":e.currentPage+1>=(0,n.unref)(s),"disable-start":e.currentPage<=0,"disable-end":e.currentPage+1>=(0,n.unref)(s),onPrev:a[0]||(a[0]=t=>c(e.currentPage-1)),onNext:a[1]||(a[1]=t=>c(e.currentPage+1)),onStart:a[2]||(a[2]=e=>c(0)),onEnd:a[3]||(a[3]=e=>c((0,n.unref)(s)-1)),onGoTo:m},null,8,["class","current","total","disable-prev","disable-next","disable-start","disable-end"])):(0,n.createCommentVNode)("v-if",!0)],2)}}},Yt=(0,f.Z)(Xt,[["__scopeId","data-v-ab7bca4a"]]),Qt={__name:"menu-contextual",props:{items:{type:Array,default:null},positionX:{type:Number,required:!0},positionY:{type:Number,required:!0}},emits:["close"],setup(e,{expose:t,emit:a}){const l=(0,n.ref)(),i=(0,n.ref)(!1);function o(e){l.value.$el.contains(e.target)||l.value.$el===e.target||(e.preventDefault(),a("close"))}return(0,n.onMounted)((()=>window.addEventListener("click",o,!0))),(0,n.onUnmounted)((()=>window.removeEventListener("click",o,!0))),t({checkOverload:function(){i.value=l.value.checkOverload()}}),(t,a)=>{const o=(0,n.resolveComponent)("fura-block-menu");return e.items?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,ref_key:"element",ref:l,class:(0,n.normalizeClass)(["menuContextual",{overloaded:i.value}]),style:(0,n.normalizeStyle)({top:`${e.positionY}px`,left:`${e.positionX}px`}),items:e.items,onOverload:a[0]||(a[0]=e=>i.value=!0)},null,8,["class","style","items"])):(0,n.createCommentVNode)("v-if",!0)}}},Jt=(0,f.Z)(Qt,[["__scopeId","data-v-138761e4"]]),ea={__name:"layout-list-details",props:{menuItem:{type:Array,default:void 0},menuView:{type:Array,default:void 0},menuContextual:{type:Array,default:void 0},menuContextualOpen:{type:Boolean,default:!1},fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},selectedItemId:{type:[Number,String],default:null},selection:{type:String,default:""},pageSize:{type:Number,default:null},currentPage:{type:Number,default:0},dataCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["menuContextualOpen","menuContextualClose","update:selectedItemId","update:orderby","clickCell","update:currentPage"],setup(e,{emit:t}){const a=e,l=(0,n.ref)(),i=(0,n.ref)({});function o({primary:e,event:a}){a.preventDefault(),i.value={x:a.clientX,y:a.clientY},t("menuContextualOpen",e),(0,n.nextTick)((()=>l.value?.checkOverload()))}function r(e){a.menuContextualOpen&&t("menuContextualClose")}return(0,n.onMounted)((()=>{document.getElementById("app").addEventListener("scroll",r)})),(0,n.onUnmounted)((()=>{document.getElementById("app").removeEventListener("scroll",r)})),(a,r)=>{const d=(0,n.resolveComponent)("fura-command-bar");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(d,{class:"layoutDetails-commandBar",items:e.menuItem,"far-items":e.menuView},null,8,["items","far-items"]),(0,n.createVNode)((0,n.unref)(Yt),{fields:e.fields,data:e.data,orderby:e.orderby,"forced-order":e.forcedOrder,"selected-item-id":e.selectedItemId,compact:"",selection:e.selection,"sticky-header":"","sticky-header-offset":44,"page-size":e.pageSize,"current-page":e.currentPage,"data-count":e.dataCount,"pagination-position":e.paginationPosition,"onUpdate:selectedItemId":r[0]||(r[0]=e=>t("update:selectedItemId",e)),"onUpdate:orderby":r[1]||(r[1]=e=>t("update:orderby",e)),onClickCell:r[2]||(r[2]=e=>t("clickCell",e)),"onUpdate:currentPage":r[3]||(r[3]=e=>t("update:currentPage",e)),onContextmenuRow:o,onContextmenuCell:o},null,8,["fields","data","orderby","forced-order","selected-item-id","selection","page-size","current-page","data-count","pagination-position"]),((0,n.openBlock)(),(0,n.createBlock)(n.Teleport,{to:"body"},[e.menuContextual&&e.menuContextualOpen?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Jt),{key:0,ref_key:"menuContextualElement",ref:l,items:e.menuContextual,"position-x":i.value.x,"position-y":i.value.y,onClose:r[4]||(r[4]=e=>t("menuContextualClose"))},null,8,["items","position-x","position-y"])):(0,n.createCommentVNode)("v-if",!0)]))],64)}}},ta=(0,f.Z)(ea,[["__scopeId","data-v-bbf1883a"]]);function aa(e,{parse:t,stringify:a,handleLeave:l}={}){const i=(0,r.useRoute)(),o=(0,r.useRouter)(),d=(0,n.ref)(i.params[e]);return(0,r.onBeforeRouteUpdate)((t=>{d.value=t.params[e]})),l&&(0,r.onBeforeRouteLeave)((t=>{d.value=t.params[e]})),{[e]:(0,n.computed)({get:()=>"function"==typeof t?t(d.value):d.value,set:t=>{d.value!==t&&o.push({params:{[e]:"function"==typeof a?a(t)||void 0:t??void 0}})}})}}function na(e,{parse:t,stringify:a,handleLeave:l}={}){const i=(0,r.useRoute)(),o=(0,r.useRouter)(),d=(0,n.ref)(i.query[e]);function u(t,n={}){n.value!==t&&o.push({path:i.path,query:{...i.query,...n,[e]:"function"==typeof a?a(t)||void 0:t??void 0}})}return(0,r.onBeforeRouteUpdate)((t=>{d.value=t.query[e]})),l&&(0,r.onBeforeRouteLeave)((t=>{d.value=t.query[e]})),{[e]:(0,n.computed)({get:()=>"function"==typeof t?t(d.value):d.value,set:e=>u(e)}),[`${e}Raw`]:(0,n.readonly)(d),[`update${la(e)}`]:u}}function la(e){return e[0].toUpperCase()+e.substring(1)}function ia(){const e=(0,r.useRoute)(),t=(0,r.useRouter)();return{goBack(a,l,{reload:i=!1}={}){if(e.query.return)if(i){const a=e.query.return.includes("?")?"&":"?";t.push(`${e.query.return}${a}reload=true`)}else t.push(e.query.return);else t.push({path:(0,n.unref)(a),query:{...(0,n.unref)(l)||e.query||{},reload:!0}})}}}function oa(e,t){return t?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase():e.toLowerCase()}function ra(e,t){return t.split("/").reduce(((e,t)=>e[t]),e)}function da(e,t){return{sortedData:(0,n.computed)((()=>{const a=Array.from((0,n.unref)(e)||[]),l=Array.from((0,n.unref)(t)||[]).reverse();for(const e of l)"asc"===e.direction?a.sort(((t,a)=>{const n=oa(ra(t,e.sentence),!0),l=oa(ra(a,e.sentence),!0);return n>l?1:n<l?-1:0})):"desc"===e.direction&&a.sort(((t,a)=>{const n=oa(ra(t,e.sentence),!0),l=oa(ra(a,e.sentence),!0);return n>l?-1:n<l?1:0}));return a}))}}const ua={__name:"dictionary-details",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=Be(),o=(0,n.computed)((()=>t.list.name)),{orderby:d,updateOrderby:u}=na("orderby",{parse:Zt,stringify:Ht,handleLeave:!0}),{selectedItemId:s}=na("selectedItemId",{parse:e=>e?Number(e):null,stringify:e=>null!=e?String(e):void 0,handleLeave:!0}),{page:c,updatePage:m}=na("page",{parse:e=>e?Number(e)-1:null,stringify:e=>null!=e?String(e+1):void 0,handleLeave:!0});(0,n.watch)(o,(e=>i.loadDictionary(e)),{immediate:!0});const p=(0,n.computed)((()=>t.list?.pageSize?t.list.pageSize:10)),f=(0,n.computed)((()=>i.data[o.value]?.length||0)),y=(0,n.computed)((()=>i.data[o.value]||[])),{sortedData:v}=da(y,d),g=(0,n.computed)((()=>{const e=c.value*p.value;return t.list?.paginated?v.value.slice(e,e+p.value):v.value})),b=(0,n.computed)((()=>{const e=t.list?.fields.find((e=>e.primary))?.name;let a=null;return e&&y.value.length>0&&(a=y.value.find((t=>t[e]===s.value))??null),t.list.permissionDenied?.(a)??{}})),h=(0,n.computed)((()=>{const e=[];return b.value.create||e.push({text:"Nou",icon:"Add",action:()=>l.push({path:`/${o.value}/create`,query:{return:a.fullPath}})}),null!=s.value&&(b.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>l.push({path:`/${o.value}/edit/${s.value}`,query:{return:a.fullPath}})}),b.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>l.push({path:`/${o.value}/delete/${s.value}`,query:{return:a.fullPath}})})),e})),C=(0,n.computed)((()=>{const e=[];return null!=s.value&&null!=s.value&&(b.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>l.push({path:`/${o.value}/edit/${s.value}`,query:{return:a.fullPath}})}),b.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>l.push({path:`/${o.value}/delete/${s.value}`,query:{return:a.fullPath}})})),[]})),x=(0,n.ref)(!1);function w(e){s.value=e,x.value=!0}function N(){x.value=!1}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(Gt),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(ta),{"menu-item":(0,n.unref)(h),"menu-contextual":(0,n.unref)(C),"menu-contextual-open":x.value,fields:e.list.fields,data:(0,n.unref)(g),orderby:(0,n.unref)(d),"forced-order":"",selection:"simple","selected-item-id":(0,n.unref)(s),"page-size":(0,n.unref)(p),"current-page":(0,n.unref)(c),"data-count":(0,n.unref)(f),"onUpdate:orderby":a[0]||(a[0]=e=>(0,n.unref)(u)(e,{selectedItemId:void 0})),"onUpdate:selectedItemId":a[1]||(a[1]=e=>s.value=e),"onUpdate:currentPage":a[2]||(a[2]=e=>(0,n.unref)(m)(e,{selectedItemId:void 0})),onMenuContextualOpen:w,onMenuContextualClose:N},null,8,["menu-item","menu-contextual","menu-contextual-open","fields","data","orderby","selected-item-id","page-size","current-page","data-count"])])),_:1},8,["subtitle"]),(0,n.createVNode)(l)],64)}}},sa={key:0},ca={class:"layoutListItem-actions"},ma={__name:"layout-list-item",props:{tabs:{type:Array,default:void 0},currentTab:{type:String,default:void 0},hasSave:{type:Boolean,default:!1},hasSaveAndNew:{type:Boolean,default:!1},hasSaveAndEdit:{type:Boolean,default:!1},hasSaveAndClose:{type:Boolean,default:!1},hasGoBack:{type:Boolean,default:!1},hasClose:{type:Boolean,default:!1},hasReset:{type:Boolean,default:!1},hasRemove:{type:Boolean,default:!1},maxWidth:{type:String,default:null},selfAling:{type:String,default:"center",validator:e=>!e||["left","center","right"].includes(e)}},emits:["update:currentTab","save","saveAndNew","saveAndEdit","saveAndClose","goBack","close","reset","remove"],setup(e){const t=e;return(a,l)=>{const i=(0,n.resolveComponent)("fura-pivot"),o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(`layoutListItem-container layoutListItem-${t.selfAling}`),style:(0,n.normalizeStyle)({maxWidth:e.maxWidth})},[(0,n.createElementVNode)("div",null,[(0,n.renderSlot)(a.$slots,"default")]),e.tabs?.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",sa,[(0,n.createVNode)(i,{tabs:e.tabs,"model-value":e.currentTab,"onUpdate:modelValue":l[0]||(l[0]=e=>a.$emit("update:currentTab",e))},null,8,["tabs","model-value"]),(0,n.renderSlot)(a.$slots,"child")])):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",ca,[e.hasSave?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,class:"layoutListItem-button",primary:"",text:"Guardar",icon:"Save",onClick:l[1]||(l[1]=e=>a.$emit("save"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndNew?((0,n.openBlock)(),(0,n.createBlock)(o,{key:1,class:"layoutListItem-button",primary:"",text:"Guardar i nou",icon:"SaveAs",onClick:l[2]||(l[2]=e=>a.$emit("saveAndNew"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndEdit?((0,n.openBlock)(),(0,n.createBlock)(o,{key:2,class:"layoutListItem-button",primary:"",text:"Guardar i continuar editant",icon:"SaveAs",onClick:l[3]||(l[3]=e=>a.$emit("saveAndEdit"))})):(0,n.createCommentVNode)("v-if",!0),e.hasSaveAndClose?((0,n.openBlock)(),(0,n.createBlock)(o,{key:3,class:"layoutListItem-button",primary:"",text:"Guardar i tancar",icon:"SaveAndClose",onClick:l[4]||(l[4]=e=>a.$emit("saveAndClose"))})):(0,n.createCommentVNode)("v-if",!0),e.hasGoBack?((0,n.openBlock)(),(0,n.createBlock)(o,{key:4,class:"layoutListItem-button",text:"Tornar",icon:"Back",onClick:l[5]||(l[5]=e=>a.$emit("goBack"))})):(0,n.createCommentVNode)("v-if",!0),e.hasClose?((0,n.openBlock)(),(0,n.createBlock)(o,{key:5,class:"layoutListItem-button",text:"Tancar",icon:"ChromeClose",onClick:l[6]||(l[6]=e=>a.$emit("close"))})):(0,n.createCommentVNode)("v-if",!0),e.hasReset?((0,n.openBlock)(),(0,n.createBlock)(o,{key:6,class:"layoutListItem-button",text:"Reiniciar",icon:"Refresh",onClick:l[7]||(l[7]=e=>a.$emit("reset"))})):(0,n.createCommentVNode)("v-if",!0),e.hasRemove?((0,n.openBlock)(),(0,n.createBlock)(o,{key:7,primary:"",class:"layoutListItem-button layoutListItem-alertButton",text:"Eliminar",icon:"Delete",onClick:l[8]||(l[8]=e=>a.$emit("remove"))})):(0,n.createCommentVNode)("v-if",!0)])],6)}}},pa=(0,f.Z)(ma,[["__scopeId","data-v-f73b1a8e"]]),fa=[];function ya(){fa.push([])}function va(){fa.pop()}function ga(...e){if(fa.length>0){const t=fa[fa.length-1];for(const a of t)a(...e)}}const ba={__name:"form-auto",props:{list:{type:Object,required:!0},form:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,l=et();(0,n.watch)((()=>a.list.name),(e=>l.load(e)),{immediate:!0});const i=(0,n.computed)((()=>Rt(a.list,a.form.fields(a.entity)))),{errorMessage:o,clean:r}=a.form.rules?a.validations.createValidation("formRules",{rules:a.form.rules}):{};function d({field:e,action:a}){r?.(),t("change",a)}var u;return u=(...e)=>a.form.onItemLoaded?.(...e),fa.length>0&&fa[fa.length-1].push(u),(t,a)=>{const l=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(e.form.class)},[(0,n.createVNode)((0,n.unref)(Ct),{"with-area-name":"",fields:(0,n.unref)(i),entity:e.entity,validations:e.validations,"cache-name":e.list.entityName||e.list.name,onChange:d},null,8,["fields","entity","validations","cache-name"]),(0,n.unref)(o)?((0,n.openBlock)(),(0,n.createBlock)(l,{key:0,style:{"grid-area":"errorMessage"},type:"error",dismiss:"",singleline:"",onDismiss:a[0]||(a[0]=e=>(0,n.unref)(r)?.())},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)((0,n.unref)(o)),1)])),_:1})):(0,n.createCommentVNode)("v-if",!0)],2)}}};async function ha(e,t){const a=ue();try{const a=await e();return t&&t(),a}catch(e){t&&t(),a.alert({title:"Error",message:e.body||"Error inesperat."})}}const Ca={__name:"dictionary-item-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=ue(),d=Be(),u=(0,o.useValidations)(),{goBack:s}=ia(),c=(0,n.computed)((()=>t.list.name)),{itemId:m}=aa("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0,handleLeave:!0}),p=(0,n.computed)((()=>t.list.fields.find((e=>e.primary)))),f=(0,n.computed)((()=>t.list.fields.find((e=>e.defaultField)))),y=qe({form:{entityName:c.value},...t.list}),v=(0,n.ref)(!1),g=(0,n.ref)("");function b(){const e=null!=m.value?d.data[c.value].find((e=>e[p.value.name]===m.value)):Object.fromEntries(t.list.fields.map((e=>[e.name,e.default])));(0,o.entitySyncData)(y,e),(0,o.entityConsolidate)(y)}function h({action:e}){e(y)}async function C(){await u.validate(y)&&(await Re(y),await d.loadDictionary(c,{force:!0}),s(`/${c.value}`))}async function x(){await u.validate(y)&&(await Re(y),await d.loadDictionary(c,{force:!0}),null===m.value?b():l.push({path:`/${c.value}/create`,query:a.query}))}function w(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",accept:async()=>{await ha((async()=>{await Ue(y),await d.loadDictionary(c,{force:!0}),l.push({path:`/${c.value}`,query:{...a.query,selectedKey:void 0}})}))}})}return(0,n.watch)(m,b),(0,n.onMounted)((async()=>{v.value=!1,await d.loadDictionary(c),b(),g.value=null===m.value?"Entrada nou element":`Modificació: ${y[f.value.name]}`,v.value=!0})),(t,a)=>{const l=(0,n.resolveComponent)("fura-dialog"),i=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(i,{class:"dictionaryItemEdit-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"dictionaryItemEdit-dialog",header:g.value},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(pa),{"has-save":"","has-save-and-new":"","has-reset":"","has-remove":null!==(0,n.unref)(m),"has-go-back":"",onSave:C,onSaveAndNew:x,onReset:b,onRemove:w,onGoBack:a[0]||(a[0]=e=>(0,n.unref)(s)(`/${(0,n.unref)(c)}`))},{default:(0,n.withCtx)((()=>[e.list.form?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ba),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(y),validations:(0,n.unref)(u),onChange:h},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ct),{key:1,fields:e.list.fields,entity:(0,n.unref)(y),validations:(0,n.unref)(u),"cache-name":e.list.name,onChange:h},null,8,["fields","entity","validations","cache-name"]))])),_:1},8,["has-remove"])])),_:1},8,["header"])])),_:1})}}},xa=(0,f.Z)(Ca,[["__scopeId","data-v-1b60de7a"]]),wa={class:"dialogFooter"},Na={__name:"dictionary-item-delete",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=ue(),o=Be(),{goBack:d}=ia(),u=(0,n.computed)((()=>t.list.name)),{itemId:s}=aa("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),c=t.list.fields.find((e=>e.primary)),m=t.list.fields.find((e=>e.defaultField)),p=(0,n.ref)("");return(0,n.onMounted)((async()=>{i.loadStart("dictionary-form/load"),await o.loadDictionary(u);const e=o.data[u.value].find((e=>e[c.$select]===s));p.value=`Esteu segurs que voleu esborrar l'element "${e?.[m.$select]}"?`,i.loadEnd("dictionary-form/load")})),(e,t)=>{const i=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),c=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(c,{class:"modalOverlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogMessage",type:"close",header:"Confirmació d'eliminació",text:p.value,onClick:t[2]||(t[2]=e=>(0,n.unref)(d)(`/${(0,n.unref)(u)}`))},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",wa,[(0,n.createVNode)(i,{primary:"",text:"Eliminar",onClick:t[0]||(t[0]=e=>async function(){await ha((async()=>{await we(`${u.value}(${s.value})`),await o.loadDictionary(u,{force:!0}),l.push({path:`/${u.value}`,query:{...a.query,selectedKey:void 0}})}))}())}),(0,n.createVNode)(i,{text:"Cancel·lar",onClick:t[1]||(t[1]=e=>(0,n.unref)(d)(`/${(0,n.unref)(u)}`))})])])),_:1},8,["text"])])),_:1})}}};function Va(e){return[{path:`/${e.name}`,component:ua,props:{list:e},children:[{path:"create",component:xa,props:{list:e}},{path:"edit/:itemId",component:xa,props:{list:e}},{path:"delete/:itemId",component:Na,props:{list:e}}]}]}const Ia=(0,l.defineStore)({id:"view",state:()=>({listName:null,definitions:[]}),actions:{async loadViews(e,t){if(e&&(this.listName!==e||t)){const t=ue();t.loadStart(`list-view/${e}/load`);const a=await xe(pe,{$filter:`${ye} eq '${e}'`,$orderby:`${be} desc,${ve} asc`});this.listName=e,this.definitions=a.value.map((e=>({...e,[ge]:JSON.parse(e[ge]||"null")}))),t.loadEnd(`list-view/${e}/load`)}}}}),Sa={class:"listDetailsDefault-buttons"},Ba={__name:"list-details-default",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=Ia(),i=(0,n.computed)((()=>t.list.name)),o=(0,n.ref)(!1);function d(){a.push(`/${i.value}/view/create`)}return(0,n.watch)(i,(e=>{e&&l.loadViews(e).then((()=>{const t=l.definitions.find((e=>e[be]))||l.definitions[0],n=t?.[ve];n&&a.push({path:`/${e}/view/query/${n}`,query:{orderby:t[ge].orderby,filter:t[ge].filter}}),o.value=!0}))}),{immediate:!0}),(t,a)=>{const l=(0,n.resolveComponent)("fura-button"),i=(0,n.resolveComponent)("fura-dialog"),r=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"listDetailsDefault-overlay"},{default:(0,n.withCtx)((()=>[o.value?((0,n.openBlock)(),(0,n.createBlock)(i,{key:0,class:"listDetailsDefault-dialog",header:"Atencio",text:"No s'ha definit cap visualització. Creeu una visualització per començar."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Sa,[(0,n.createVNode)(l,{primary:"",text:"Crea una nova visualització",onClick:d})])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1})])),_:1},8,["subtitle"])}}},ka=(0,f.Z)(Ba,[["__scopeId","data-v-0871c081"]]),Ea={__name:"list-details",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=(0,r.useRoute)(),i=Ia(),d=ue(),u=(0,n.computed)((()=>t.list.name)),{viewName:s}=aa("viewName"),{filter:c}=na("filter"),{orderby:p,orderbyRaw:f,updateOrderby:y}=na("orderby",{parse:Zt,stringify:Ht}),{selectedItemId:v}=na("selectedItemId",{parse:e=>e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),{page:g,updatePage:b}=na("page",{parse:e=>e?Number(e)-1:null,stringify:e=>null!=e?String(e+1):void 0}),{reload:h}=na("reload",{parse:e=>Boolean(e)});(0,n.watch)(u,(async e=>{await i.loadViews(e),s.value&&!i.definitions.some((e=>e[ve]===s.value))&&a.push(`/${e}`)}),{immediate:!0});const C=(0,n.computed)((()=>t.list?.fields.find((e=>e.primary)))),x=(0,n.computed)((()=>t.list?.fields.filter((e=>e.loadAlwaysInView))??[])),w=(0,n.computed)((()=>i.definitions.find((e=>e[ve]===s.value)))),N=(0,n.computed)((()=>{const e=Array.from(w.value?.[ge].fields||[]);return e.includes(C.value?.name)||e.unshift(C.value?.name),e.map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e))})),V=(0,n.computed)((()=>t.list?.pageSize?t.list.pageSize:10)),I=(0,n.computed)((()=>{if("function"==typeof t.list.detailsFilter){const e=t.list.detailsFilter(),a="string"==typeof e?e:K(e);return c.value?`(${a}) and (${c.value})`:a}return c.value})),S=(0,n.computed)((()=>({...Ne([C.value,...N.value,...x.value.filter((e=>!N.value?.some((t=>e.name===t.name))))]),$filter:I.value||void 0,$orderby:f.value||void 0,$skip:g.value>0?g.value*V.value:void 0,$top:V.value,$count:!0}))),B=(0,n.computed)((()=>t.list.entityName||t.list.name)),{data:k,isLoading:E,load:A}=function(e,t,a,n){const l=m();return(0,o.useFetchGet)([me,e].flat(),t,{Authorization:l.jwt},void 0)}(B,S);(0,n.watch)(h,(e=>{e&&A(),a.replace({path:l.path,query:{...l.query,reload:void 0}})}));const O=(0,n.computed)((()=>k.value?.value||[])),D=(0,n.computed)((()=>k.value?.["@odata.count"]));(0,n.watch)(E,(e=>e?d.loadStart(`list/${u.value}/load`):d.loadEnd(`list/${u.value}/load`)),{immediate:!0});const $=(0,n.computed)((()=>{if(C.value&&O.value.length>0){const e=C.value.name;return O.value.find((t=>t[e]===v.value))??null}return null})),T=(0,n.computed)((()=>t.list.permissionDenied?.($.value)??{})),_=(0,n.computed)((()=>{const e=[];return T.value.create||e.push({text:"Nou",icon:"Add",action:()=>a.push({path:`/${u.value}/create`,query:{return:l.fullPath}})}),null!=v.value&&(T.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>a.push({path:`/${u.value}/edit/${v.value}`,query:{return:l.fullPath}})}),T.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>a.push({path:`/${u.value}/delete/${v.value}`,query:{...l.query,viewName:s.value}})})),T.value.edit||"auto"!==t.list.form?.component||e.push({text:"Editar valors",icon:"WindowEdit",action:()=>a.push({path:`/${u.value}/view/grid/${s.value}`,query:l.query})}),null==v.value&&s.value&&!T.value.export&&e.push({text:"Exportar",icon:"Export",children:[{text:"a PDF",icon:"PDF",action:()=>a.push({path:`/${u.value}/view/query/${s.value}/export`,query:{...l.query,format:"pdf"}})},{text:"a Excel",icon:"ExcelDocument",action:()=>a.push({path:`/${u.value}/view/query/${s.value}/export`,query:{...l.query,format:"excel"}})}]}),e})),F=(0,n.computed)((()=>t.list.menuUpdater?t.list.menuUpdater(_.value,$.value,{contextual:!1}):_.value)),q=(0,n.computed)((()=>{const e=[{text:s.value??"",children:[...i.definitions?.map((e=>({text:e[ve],action:()=>a.push({path:`/${u.value}/view/query/${e[ve]}`,query:{orderby:e[ge].orderby,filter:e[ge].filter}})})))??[],{type:"divider"},{text:"Crea una visualització",icon:"Add",action:()=>a.push({path:`/${u.value}/view/create`,query:{filter:l.query.filter,return:l.fullPath}})}]}];return s.value&&e[0].children.push({text:"Modifica",icon:"CSS",action:()=>a.push({path:`/${u.value}/view/edit/${s.value}`,query:{filter:l.query.filter,return:l.fullPath}})}),t.list.filter&&e.push({icon:"Filter",action:()=>a.push({path:`/${u.value}/view/query/${s.value}/filter`,query:{...l.query}})}),e})),R=(0,n.computed)((()=>{const e=[];return T.value.edit||e.push({text:"Modificar",icon:"Edit",action:()=>a.push({path:`/${B.value}/edit/${v.value}`,query:{return:l.fullPath}})}),T.value.delete||e.push({text:"Esborrar",icon:"Delete",action:()=>a.push({path:`/${B.value}/delete/${v.value}`,query:{...l.query,viewName:s.value}})}),e})),U=(0,n.computed)((()=>t.list.menuUpdater?t.list.menuUpdater(R.value,$.value,{contextual:!0}):R.value)),j=(0,n.ref)(!1);function P(e){v.value=e,j.value=!0}function M(){j.value=!1}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(Gt),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(ta),{"menu-item":(0,n.unref)(F),"menu-view":(0,n.unref)(q),"menu-contextual":(0,n.unref)(U),"menu-contextual-open":j.value,fields:(0,n.unref)(N),data:(0,n.unref)(O),orderby:(0,n.unref)(p),selection:"simple","selected-item-id":(0,n.unref)(v),"page-size":(0,n.unref)(V),"current-page":(0,n.unref)(g),"data-count":(0,n.unref)(D),"onUpdate:orderby":a[0]||(a[0]=e=>(0,n.unref)(y)(e,{selectedItemId:void 0})),"onUpdate:selectedItemId":a[1]||(a[1]=e=>v.value=e),"onUpdate:currentPage":a[2]||(a[2]=e=>(0,n.unref)(b)(e,{selectedItemId:void 0})),onMenuContextualOpen:P,onMenuContextualClose:M},null,8,["menu-item","menu-view","menu-contextual","menu-contextual-open","fields","data","orderby","selected-item-id","page-size","current-page","data-count"])])),_:1},8,["subtitle"]),(0,n.createVNode)(l)],64)}}},Aa={class:"detailsGrid fura-stickyHeader"},Oa={class:"detailsGrid-headerTitle"},Da=["textContent"],$a=(e=>((0,n.pushScopeId)("data-v-1653596e"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("th",{width:"88px"},null,-1))),Ta={key:0},_a=["colspan"],Fa={__name:"details-grid",props:{list:{type:Object,required:!0},columns:{type:Array,required:!0},elements:{type:Array,required:!0},stickyHeader:{type:Boolean,default:!1},stickyHeaderOffset:{type:[String,Number],default:null}},emits:["update","focus","blur","save","reset"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>"number"==typeof a.stickyHeaderOffset&&a.stickyHeaderOffset?{top:`${a.stickyHeaderOffset}px`}:"string"==typeof a.stickyHeaderOffset&&a.stickyHeaderOffset?{top:a.stickyHeaderOffset}:void 0));return(a,i)=>{const o=(0,n.resolveComponent)("fura-icon"),r=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createElementBlock)("table",Aa,[(0,n.createElementVNode)("thead",null,[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.columns,((e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)("th",{key:t,class:"detailsGrid-headerCell",style:(0,n.normalizeStyle)((0,n.unref)(l))},[(0,n.createElementVNode)("div",Oa,[(0,n.createElementVNode)("span",{textContent:(0,n.toDisplayString)(e.title)},null,8,Da),e.icon?((0,n.openBlock)(),(0,n.createBlock)(o,{key:0,class:"detailsGrid-headerIcon",name:e.icon},null,8,["name"])):(0,n.createCommentVNode)("v-if",!0)])],4)))),128)),$a])]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.elements,((a,l)=>((0,n.openBlock)(),(0,n.createElementBlock)("tbody",{key:l},[(0,n.createElementVNode)("tr",null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.columns,((i,o)=>((0,n.openBlock)(),(0,n.createElementBlock)("td",{key:o},[(0,n.unref)(ht)[i.field.type].gridField?((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(ht)[i.field.type].gridField),{key:0,entity:a.entity,field:i.field,validations:a.validations,"cache-name":e.list.entityName||e.list.name,onChange:e=>t("update",{index:l,field:i.field,action:e}),onFocus:e=>t("focus",{index:l,field:i.field,event:e}),onBlur:e=>t("blur",{index:l,field:i.field,event:e})},null,40,["entity","field","validations","cache-name","onChange","onFocus","onBlur"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(ht)[i.field.type].detailsCell),{key:1,field:i.field,row:a.data},null,8,["field","row"]))])))),128)),(0,n.createElementVNode)("td",null,[a.hasPendingChanges?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createVNode)(r,{type:"icon",icon:"Save",onClick:e=>t("save",l)},null,8,["onClick"]),(0,n.createVNode)(r,{type:"icon",icon:"Reset",onClick:e=>t("reset",l)},null,8,["onClick"])],64)):(0,n.createCommentVNode)("v-if",!0)])]),a.errorMessage?((0,n.openBlock)(),(0,n.createElementBlock)("tr",Ta,[(0,n.createElementVNode)("td",{colspan:e.columns.length+1},[(0,n.createVNode)(d,{type:"error",dismiss:"",singleline:"",onDismiss:e=>a.clean?.()},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(a.errorMessage),1)])),_:2},1032,["onDismiss"])],8,_a)])):(0,n.createCommentVNode)("v-if",!0)])))),128))])}}},qa=(0,f.Z)(Fa,[["__scopeId","data-v-1653596e"]]),Ra={__name:"layout-list-grid",props:{list:{type:Object,required:!0},menuItem:{type:Array,default:void 0},menuView:{type:Array,default:void 0},fields:{type:Array,default:void 0},elements:{type:Array,default:void 0},orderby:{type:Array,default:()=>[]},pageSize:{type:Number,default:null},currentPage:{type:Number,default:0},elementsCount:{type:Number,default:null},paginationPosition:{type:String,default:"bottomCenter"}},emits:["update","focus","blur","save","reset"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>a.fields.map(((e,t)=>({index:t,type:e.type,title:e.label,icon:Wt(a.orderby.find((t=>t.sentence===Ve(e)))),field:e}))))),i=(0,n.computed)((()=>{const{pageSize:e,elementsCount:t}=a;return"number"==typeof e&&"number"==typeof t})),o=(0,n.computed)((()=>Math.ceil(a.elementsCount/a.pageSize))),r=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"topCenter":case"topRight":return"layoutListGrid-navTop";case"bottomLeft":case"bottomCenter":case"bottomRight":return"layoutListGrid-navBottom";default:return}})),d=(0,n.computed)((()=>{switch(a.paginationPosition){case"topLeft":case"bottomLeft":return"layoutListGrid-left";case"topCenter":case"bottomCenter":return"layoutListGrid-center";case"topRight":case"bottomRight":return"layoutListGrid-right";default:return}}));return(a,u)=>{const s=(0,n.resolveComponent)("fura-command-bar"),c=(0,n.resolveComponent)("fura-spin-nav");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(s,{class:"layoutListGrid-commandBar",items:e.menuItem,"far-items":e.menuView},null,8,["items","far-items"]),(0,n.createElementVNode)("div",{class:(0,n.normalizeClass)((0,n.unref)(r))},[(0,n.createVNode)((0,n.unref)(qa),{class:"layoutListGrid-details",list:e.list,columns:(0,n.unref)(l),elements:e.elements,"sticky-header":"","sticky-header-offset":44,onUpdate:u[0]||(u[0]=e=>t("update",e)),onFocus:u[1]||(u[1]=e=>t("focus",e)),onBlur:u[2]||(u[2]=e=>t("blur",e)),onSave:u[3]||(u[3]=e=>t("save",e)),onReset:u[4]||(u[4]=e=>t("reset",e))},null,8,["list","columns","elements"]),(0,n.unref)(i)&&(0,n.unref)(r)&&(0,n.unref)(d)&&e.elements.length>0?((0,n.openBlock)(),(0,n.createBlock)(c,{key:0,class:(0,n.normalizeClass)(["layoutListGrid-navigation",(0,n.unref)(d)]),current:e.currentPage+1,total:(0,n.unref)(o),"end-button":"","start-button":"","disable-prev":"","disable-next":"","disable-start":"","disable-end":""},null,8,["class","current","total"])):(0,n.createCommentVNode)("v-if",!0)],2)],64)}}},Ua=(0,f.Z)(Ra,[["__scopeId","data-v-7472afbe"]]),ja={__name:"list-details-grid",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=(0,r.useRoute)(),i=Ia(),d=et(),u=ue();d.setContextName(t.list.name),d.load(t.list.name);const s=(0,n.ref)(!0),c=l.params.viewName,p=l.query.page?Number(l.query.page)-1:null,f=t.list?.pageSize?t.list.pageSize:10,y=(0,n.shallowRef)([]),v=(0,n.shallowRef)(null),g=(0,o.useEntityCollection)(je(t.list,t.list.form)),b=(0,n.ref)(0),h=(0,n.reactive)([]),C=(0,n.getCurrentScope)();i.loadViews(t.list.name).then((async()=>{u.loadStart(`list/${t.list.name}/load`),c&&!i.definitions.some((e=>e[ve]===c))&&a.push(`/${t.list.name}`);const e=i.definitions.find((e=>e[ve]===c));y.value=e[ge].fields.map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e));let r=l.query.filter;if("function"==typeof t.list.detailsFilter){const e=t.list.detailsFilter(),a="string"==typeof e?e:K(e);r=l.query.filter?`(${a}) and (${l.query.filter})`:a}const d={$filter:r||void 0,$orderby:l.query.orderby||void 0,$skip:p>0?p*f:void 0,$top:f,$count:!0};v.value=await function(e,t){const a=m();return(0,o.entityLoadCollection)(e,me,{Authorization:a.jwt},t)}(g,d),b.value=v.value?.["@odata.count"];const x=t.list.fields.find((e=>e.primary)).name;for(const e of g.values()){const a=Rt(t.list,t.list.form.fields(e)).filter((e=>!y.value.some((t=>t.name===e.name))&&"function"==typeof ht[e.type]?.getEntityValue)),l=(0,o.useValidations)(),{errorMessage:i,clean:r}=t.list.form.rules?l.createValidation("formRules",{rules:t.list.form.rules}):{};C.run((()=>{l.createField(x,(0,n.computed)((()=>e[x])));for(const t of a)l.createField(t.name,(0,n.computed)((()=>ht[t.type].getEntityValue(t,e))))})),h.push({entity:e,data:(0,o.entityData)(e),hasPendingChanges:!1,validations:l,errorMessage:i,clean:r})}s.value=!1,u.loadEnd(`list/${t.list.name}/load`)}));const x=(0,n.computed)((()=>(0,o.entityHasPendingChanges)(g)?[{text:"Guardar",icon:"Save",action:V},{text:"Reiniciar",icon:"Refresh",action:()=>{(0,o.entitySyncData)(g,v.value.value);for(const e of h)e.clean(),e.data=(0,o.entityData)(e.entity),e.hasPendingChanges=(0,o.entityHasPendingChanges)(e.entity)}},{text:"Tornar",icon:"Back",action:()=>{u.confirm({title:"Alerta!",message:"Hi han canvis sense guardar. Aquests canvis es perdràn. Voleu continuar?.",accept(){a.push({path:`/${t.list.name}/view/query/${c}`,query:l.query})}})}}]:[{text:"Tornar",icon:"Back",action:()=>{a.push({path:`/${t.list.name}/view/query/${c}`,query:l.query})}}])),w=(0,n.computed)((()=>{const e=[{text:c??"",disabled:!0}];return t.list.filter&&e.push({icon:"Filter",disabled:!0}),e}));function N({index:e,action:t}){const a=h[e];t(a.entity),a.hasPendingChanges=(0,o.entityHasPendingChanges)(a.entity),a.clean()}function V(){return ha((async()=>await Promise.all(h.map((async(e,t)=>{e.hasPendingChanges&&await e.validations.validate(e.entity)&&(await Re(e.entity),(0,o.entityConsolidate)(e.entity),e.hasPendingChanges=!1,v.value.value[t]=(0,o.entityData)(e.entity))})))))}async function I(e){const t=h[e];await t.validations.validate(t.entity)&&await ha((async()=>{await Re(t.entity),(0,o.entityConsolidate)(t.entity),t.hasPendingChanges=!1,v.value.value[e]=(0,o.entityData)(t.entity)}))}function S(e){const t=h[e];t.clean(),(0,o.entitySyncData)(t.entity,v.value.value[e]),t.hasPendingChanges=(0,o.entityHasPendingChanges)(t.entity)}return(t,a)=>{const i=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(Gt),{subtitle:e.list.label},{default:(0,n.withCtx)((()=>[s.value?(0,n.createCommentVNode)("v-if",!0):((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ua),{key:0,list:e.list,"menu-item":(0,n.unref)(x),"menu-view":(0,n.unref)(w),fields:(0,n.unref)(y),elements:h,orderby:(0,n.unref)(Zt)((0,n.unref)(l).query.orderby),"page-size":(0,n.unref)(f),"current-page":(0,n.unref)(p),"elements-count":b.value,onUpdate:N,onSave:I,onReset:S},null,8,["list","menu-item","menu-view","fields","elements","orderby","page-size","current-page","elements-count"]))])),_:1},8,["subtitle"]),(0,n.createVNode)(i)],64)}}},Pa={__name:"filter-form-combo",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:void 0,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=et(),i=(0,n.shallowRef)([]);return(0,n.watchEffect)((()=>{i.value=(l.data[a.cacheName]?.[a.field.name]||[]).map((e=>({value:e[a.field.valueKey||"value"],text:e[a.field.textKey||"text"]})))})),(a,l)=>{const o=(0,n.resolveComponent)("fura-combo-box");return(0,n.openBlock)(),(0,n.createBlock)(o,{label:e.field.label,options:(0,n.unref)(i),multiple:e.field.multiple,"model-value":e.modelValue,"onUpdate:modelValue":l[0]||(l[0]=e=>t("update:modelValue",e))},null,8,["label","options","multiple","model-value"])}}},Ma={__name:"filter-form-csv",props:{field:{type:Object,required:!0},cacheName:{type:String,default:""},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=(0,n.computed)({get:()=>Array.isArray(a.modelValue)?a.modelValue.join():"",set(e){t("update:modelValue",e.split(","))}});return(t,a)=>{const i=(0,n.resolveComponent)("fura-text-field");return(0,n.openBlock)(),(0,n.createBlock)(i,{label:e.field.label,modelValue:(0,n.unref)(l),"onUpdate:modelValue":a[0]||(a[0]=e=>(0,n.isRef)(l)?l.value=e:null)},null,8,["label","modelValue"])}}},Ka={key:3},La={key:6,class:"filterForm-multiple"},za={__name:"filter-form",props:{fields:{type:Array,required:!0},modelValue:{type:Array,required:!0},cacheName:{type:String,default:""}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e;function l(e){return a.modelValue.find((t=>t[0]===e.name))?.[1]}function i(e,n){if(null==n||""===n||Array.isArray(n)&&0===n.length)t("update:modelValue",a.modelValue.filter((t=>t[0]!==e.name)));else{const l=a.modelValue.findIndex((t=>t[0]===e.name));t("update:modelValue",-1===l?[...a.modelValue,[e.name,n]]:[...a.modelValue.slice(0,l),[e.name,n],...a.modelValue.slice(l+1)])}}return(a,o)=>{const r=(0,n.resolveComponent)("fura-text-field"),d=(0,n.resolveComponent)("fura-number-field"),u=(0,n.resolveComponent)("fura-date-picker"),s=(0,n.resolveComponent)("fura-checkbox"),c=(0,n.resolveComponent)("FilterForm",!0);return(0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.fields,(a=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:a.name},["text"===a.type?((0,n.openBlock)(),(0,n.createBlock)(r,{key:0,label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"number"===a.type?((0,n.openBlock)(),(0,n.createBlock)(d,{key:1,label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"date"===a.type?((0,n.openBlock)(),(0,n.createBlock)(u,{key:2,label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["label","model-value","onUpdate:modelValue"])):"checkbox"===a.type?((0,n.openBlock)(),(0,n.createElementBlock)("div",Ka,[(0,n.createVNode)(s,{class:"filterForm-checkbox",label:a.label,"model-value":l(a),"onUpdate:modelValue":e=>i(a,!!e&&null),indeterminate:"boolean"!=typeof l(a),"onUpdate:indeterminate":e=>i(a,!0)},null,8,["label","model-value","onUpdate:modelValue","indeterminate","onUpdate:indeterminate"])])):"combo"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Pa),{key:4,field:a,"cache-name":e.cacheName,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["field","cache-name","model-value","onUpdate:modelValue"])):"csv"===a.type?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Ma),{key:5,field:a,"model-value":l(a),"onUpdate:modelValue":e=>i(a,e)},null,8,["field","model-value","onUpdate:modelValue"])):Array.isArray(a)?((0,n.openBlock)(),(0,n.createElementBlock)("div",La,[(0,n.createVNode)(c,{fields:a,"model-value":e.modelValue,"onUpdate:modelValue":o[0]||(o[0]=e=>t("update:modelValue",e))},null,8,["fields","model-value"])])):(0,n.createCommentVNode)("v-if",!0)],64)))),128)}}},Ga=(0,f.Z)(za,[["__scopeId","data-v-3a975916"]]),Wa=["onSubmit"],Za={key:0,class:"filterGroups"},Ha=["onClick"],Xa={class:"content fura-slideDownIn20"},Ya={class:"actions"},Qa={__name:"list-details-filter-panel",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=et(),{expanded:o,updateExpanded:d}=na("expanded");i.setContextName(t.list.name),i.load(t.list.name);const u=Rt(t.list,t.list.filter),s=[],c=[],m=[];for(const e of u)if(e.type in ht){const t=ht[e.type],a=t.getFilterCondition?.(e,u);a&&s.push(a);const n=t.getFilterInterface?.(e,u);if(n)if(e.filterGroup){const t=m.find((t=>t.name===e.filterGroup));t?t.fields.push(n):m.push({name:e.filterGroup,fields:[n]})}else c.push(n)}const p=new W(s,"and"),f=(0,n.ref)(a.query.filter?p.readFilter(a.query.filter):[]);function y(){l.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:{...a.query,filter:p.writeFilter(f.value)||void 0,selectedItemId:void 0,page:void 0}})}function v(){l.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:{...a.query,filter:void 0}})}function g(){l.push({path:`/${t.list.name}/view/query/${a.params.viewName}`,query:a.query})}function b(e){return Array.isArray(o.value)?o.value.includes(e.name):o.value===e.name}const h=(0,n.ref)();return(0,n.onMounted)((()=>{h.value.querySelector('input, select, textarea, [tabindex]:not([tabindex="-1"])')?.focus()})),(t,a)=>{const l=(0,n.resolveComponent)("fura-icon"),i=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-panel"),u=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(u,{fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(y,["prevent"])},[(0,n.createVNode)(r,{type:"medium","header-text":`Filtrar ${e.list.label}`,onClick:g},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Ya,[(0,n.createVNode)(i,{primary:"",text:"Cerca",icon:"Filter","form-role":"submit"}),(0,n.createVNode)(i,{class:"clearFilter",primary:"",text:"Esborra el filtre",icon:"ClearFilter",onClick:v}),(0,n.createVNode)(i,{text:"Cancela",icon:"Cancel",onClick:g})])])),default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",{ref_key:"fieldsContainer",ref:h},[m.length>0?((0,n.openBlock)(),(0,n.createElementBlock)("div",Za,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(m,(t=>(0,n.createElementVNode)("div",{key:t.name,class:(0,n.normalizeClass)(["item",{expanded:b(t)}])},[t.name?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:0,class:"title",type:"button",onClick:(0,n.withModifiers)((e=>function(e){b(e)?Array.isArray(o.value)?d(o.value.filter((t=>t!==e.name))):d(null):Array.isArray(o.value)?d([...o.value,e.name]):o.value?d([o.value,e.name]):d(e.name)}(t)),["stop"])},[(0,n.createVNode)(l,{class:"expanderIcon",name:"ChevronDown"}),(0,n.createTextVNode)(" "+(0,n.toDisplayString)(t.name),1)],8,Ha)):(0,n.createCommentVNode)("v-if",!0),(0,n.createElementVNode)("div",Xa,[(0,n.createVNode)((0,n.unref)(Ga),{fields:t.fields,"cache-name":e.list.name,modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value=e)},null,8,["fields","cache-name","modelValue"])])],2))),64))])):(0,n.createCommentVNode)("v-if",!0),(0,n.createVNode)((0,n.unref)(Ga),{fields:c,"cache-name":e.list.name,modelValue:f.value,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value=e)},null,8,["cache-name","modelValue"])],512)])),_:1},8,["header-text"])],40,Wa)])),_:1})}}},Ja=(0,f.Z)(Qa,[["__scopeId","data-v-72612ae2"]]);function en(e){const t=String(e??"");return t.includes('"')||t.includes(";")||t.includes("\n")?`"${t.replaceAll('"','""')}"`:t}async function tn(e,t){const a=[];for(const n of t){const t=[];for(const a of e)if("function"==typeof ht[a.type]?.getCsvValueFromEntity){const e=en(await ht[a.type].getCsvValueFromEntity(a,n));t.push(e)}else t.push("");a.push(t)}return a}var an=u(525),nn=u(732);function ln(){const e=(e,t=2)=>e.toString().padStart(t,"0"),t=new Date(Date.now());return`${e(t.getDate())}/${e(t.getMonth()+1)}/${e(t.getFullYear(),4)}`}const on={class:"dialogAlert-close"},rn={__name:"list-details-export",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=Ia(),o=(0,n.ref)(null),d=(0,n.ref)(),u=(0,n.computed)((()=>"pdf"===a.query.format?`${t.list.label}.pdf`:"excel"===a.query.format?`${t.list.label}.csv`:`${t.list.label}.txt`));function s(){l.back()}async function c(e,n){return"pdf"===a.query.format?await async function(e,t,{title:a}){an.vfs=nn.pdfMake.vfs;const n=await async function(e,t){const a=[];for(const n of t){const t=[];for(const a of e)if("function"==typeof ht[a.type]?.getTextValueFromEntity){const e=await ht[a.type].getTextValueFromEntity(a,n);t.push(e)}else t.push("");a.push(t)}return a}(e,t),l={pageSize:"A4",pageMargins:[30,60,30,30],pageOrientation:"landscape",header:(e,t)=>({margin:[30,30,20,0],columns:[{text:"Assignació places NEE",width:165,alignment:"left"},{text:a,width:"*",style:"tableHeaderCenter"},{table:{widths:["auto","auto"],body:[[{text:"Pàg.",alignment:"left"},{text:e+" de "+t,alignment:"right"}],[{text:"Data",alignment:"left"},{text:ln(),alignment:"right"}]]},layout:"noBorders",width:"80",style:"tableHeaderRight"}]}),content:[{table:{headerRows:1,dontBreakRows:!0,border:"none",body:[e.map((e=>({text:e.label,bold:!0,alignment:e.align||"left"}))),...n.map((t=>t.map(((t,a)=>({text:t,align:e[a].align||"left"})))))]},layout:"noBorders",margin:[0,5,0,5]}],styles:{tableHeader:{bold:!0},tableHeaderCenter:{bold:!0,alignment:"center"},tableHeaderRight:{bold:!0,alignment:"right"},boldFirst:{bold:!0,margin:[0,6,0,0]},bold:{bold:!0},normal:{bold:!1}},defaultStyle:{fontSize:9}};return await new Promise((e=>{an.createPdf(l).getDataUrl(e)}))}(e,n,{title:t.list.label}):"excel"===a.query.format?await async function(e,t){const a=[e.map((e=>en(e.label))),...await tn(e,t)].map((e=>e.join(";"))).join("\n");return"data:text/csv;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent("\ufeff"+a+"\n")))}(e,n):void 0}return(0,n.onMounted)((async()=>{await i.loadViews(t.list.name);const e=i.definitions.find((e=>e[ve]===a.params.viewName)),l=Array.from(e[ge].fields).map((e=>t.list.fields.find((t=>t.name===e)))).filter((e=>e)),r={...Ne(l),$filter:a.query.filter||void 0,$orderby:a.query.orderby||void 0},u=await xe(t.list.name,r);o.value=await c(l,u.value),await(0,n.nextTick)(),d.value.$el.click(),s()})),(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-dialog"),i=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)(i,{class:"listExport-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"listExport-dialog",header:"Exportació de dades",text:"Fitxer llest per descarregar."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",on,[o.value?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,ref_key:"download",ref:d,primary:"",text:"Descarrega",download:(0,n.unref)(u),href:o.value,target:"_blank"},null,8,["download","href"])):(0,n.createCommentVNode)("v-if",!0),(0,n.createVNode)(a,{text:"Tancar",onClick:s})])])),_:1})])),_:1})}}},dn=(0,f.Z)(rn,[["__scopeId","data-v-392e43be"]]),un=e=>((0,n.pushScopeId)("data-v-5f58ff4a"),e=e(),(0,n.popScopeId)(),e),sn={class:"list-view-fields"},cn=un((()=>(0,n.createElementVNode)("div",null,null,-1))),mn={class:"list-view-fields"},pn=un((()=>(0,n.createElementVNode)("div",{class:"list-view-orderBy"},null,-1))),fn={__name:"list-view-simple-config",props:{fields:{type:Array,required:!0},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>{const{modelValue:e,fields:t}=a;return[{value:null,text:"",disabeld:!1},...t.map((t=>({value:t.name,text:t.label,disabled:e.some((e=>e.name===t.name))})))]}));function i(e){e&&t("update:modelValue",[...a.modelValue,{name:e,direction:null}])}function o(e){const t=a.fields.find((t=>t.name===e));return t&&t.orderby?t.orderby:[{value:"asc",text:"A -> Z"},{value:"desc",text:"Z -> A"}]}return(r,d)=>{const u=(0,n.resolveComponent)("fura-dropdown"),s=(0,n.resolveComponent)("llesca-stack-draggable");return(0,n.openBlock)(),(0,n.createBlock)(s,{"primary-key":"name","model-value":e.modelValue,"onUpdate:modelValue":d[0]||(d[0]=e=>t("update:modelValue",e))},{default:(0,n.withCtx)((e=>[(0,n.createElementVNode)("div",sn,[(0,n.createVNode)(u,{class:"list-view-field",options:(0,n.unref)(l),"model-value":e.item.name,"onUpdate:modelValue":n=>function(e,n){const l=[...a.modelValue];n?l[e]={name:n,direction:l[e].direction}:l.splice(e,1),t("update:modelValue",l)}(e.index,n)},null,8,["options","model-value","onUpdate:modelValue"]),(0,n.createVNode)(u,{class:"list-view-orderBy",options:o(e.item.name),"model-value":e.item.direction,"onUpdate:modelValue":n=>function(e,n){const l=[...a.modelValue];l[e]={name:l[e].name,direction:n},t("update:modelValue",l)}(e.index,n)},null,8,["options","model-value","onUpdate:modelValue"]),cn])])),footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",mn,[(0,n.createVNode)(u,{class:"list-view-field",options:(0,n.unref)(l),"onUpdate:modelValue":i},null,8,["options"]),pn])])),_:1},8,["model-value"])}}},yn=(0,f.Z)(fn,[["__scopeId","data-v-5f58ff4a"]]),vn={class:"layout"},gn={class:"viewOptions"},bn={class:"actions"},hn={__name:"list-view-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=ue(),d=Ia(),u=m(),s=(0,n.computed)((()=>a.params.viewName??null)),c=(0,n.computed)((()=>d.definitions.find((e=>e[ve]===s.value))?.[fe])),p=(0,n.computed)((()=>t.list.name));d.loadViews(p.value).then((()=>{if(s.value){const e=d.definitions.find((e=>e[ve]===s.value));e||alert("error"),b(e)}}));const f=t.list.fields.filter((e=>e.label)),y=(0,n.reactive)({name:"",defaultView:!1,selectedFields:[],saveFilter:!1,nameErrorMessage:null,showErrorMessage:!1}),v=(0,n.computed)((()=>Ht(y.selectedFields.filter((e=>e.name)).map((e=>({sentence:Ve(t.list.fields.find((t=>t.name===e.name))),direction:e.direction})))))),g=(0,n.computed)((()=>!d.definitions.some((e=>1===e[be]))||d.definitions[0][ve]===y.name));function b(e={}){const a=e?.[ge]?.fields??[],n=Zt(e?.[ge]?.orderby??"")??[],l=a.map((e=>{const a=t.list.fields.find((t=>t.name===e));return{name:e,direction:n.find((e=>e.sentence===Ve(a)))?.direction}}));y.name=e?.[ve]??"",y.defaultView=!!e?.[be],y.selectedFields=l,y.saveFilter=!1}async function h(){if(function(){let e=!0;return y.nameErrorMessage=null,y.showErrorMessage=!1,y.name?d.definitions.some((e=>e[fe]!==c.value&&e[ve]===y.name))&&(e=!1,y.nameErrorMessage="Ja existeix una visualització amb aquest nom."):(e=!1,y.nameErrorMessage="Cal posar un nom a la visualització,"),0===y.selectedFields.length&&(e=!1,y.showErrorMessage=!0),e}()){const e=y.defaultView?d.definitions.filter((e=>e[be])).map((e=>({atomicityGroup:"saveView",id:`saveView-patch${e[fe]}`,method:"PATCH",url:`/${pe}(${e[fe]})`,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:u.jwt},body:{[be]:0}}))):[];e.push(function(){const e=d.definitions.find((e=>e[ve]===s.value));if(null!==s.value&&!e)throw new Error("La vista a actualitzar no s'ha trobat.");const[t,n,l]=void 0===e?["saveView-post","POST",`/${pe}`]:[`saveView-put-${e[fe]}`,"PUT",`/${pe}(${e[fe]})`];return{atomicityGroup:"saveView",id:t,method:n,url:l,headers:{"Content-Type":"application/json",Authorization:u.jwt},body:{[fe]:e?.[fe],[ye]:p.value,[ve]:y.name,VIEWTYPE:"list",[ge]:JSON.stringify({fields:y.selectedFields.filter((e=>e.name)).map((e=>e.name)),orderby:v.value,filter:y.saveFilter?a.query.filter||void 0:e?.[ge].filter}),[be]:g.value||y.defaultView?1:0}}}()),await async function(e){let t=!0;i.loadStart(`list/${p.value}/list-edit/save`);const{responses:a}=await function(e,t,a,n={},{withoutDialog:l=!1}={}){return Ce(Symbol("requestPost"),(()=>o.odata.requestPost([me,e].flat(),t,a,{Authorization:m().jwt,...n})),l)}("$batch",{requests:e});return a.some((e=>201!==e.status&&204!==e.status))&&(i.alert({title:"Error",message:"Error inesperat"}),t=!1),i.loadEnd(`list/${p.value}/list-edit/save`),t}(e)&&(await d.loadViews(p.value,!0),l.push({path:`/${p.value}/view/query/${y.name}`,query:{orderby:v.value}}))}}function C(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquesta visualització?. Aquesta acció no es pot desfer.",accept:async()=>{await we(`${pe}(${c.value})`),await d.loadViews(p.value,!0),l.push(`/${p.value}`)}})}function x(){b(d.definitions.find((e=>e[ve]===s.value)))}function w(){a.query.return?l.push(a.query.return):l.push(`/${p.value}/view/query/${y.name}`)}return(t,a)=>{const l=(0,n.resolveComponent)("fura-label"),i=(0,n.resolveComponent)("fura-separator"),o=(0,n.resolveComponent)("fura-text-field"),r=(0,n.resolveComponent)("fura-checkbox"),d=(0,n.resolveComponent)("fura-button"),u=(0,n.resolveComponent)("fura-message-bar");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{class:"baseLayout",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",vn,[(0,n.createVNode)(i,{class:"separatorLlista","align-content":"center"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("Llista")])),_:1})])),_:1}),(0,n.createVNode)(o,{required:"",name:"name",class:"name",label:"Nom de la visualització","error-message":y.nameErrorMessage,modelValue:y.name,"onUpdate:modelValue":[a[0]||(a[0]=e=>y.name=e),a[1]||(a[1]=e=>y.nameErrorMessage=null)]},null,8,["error-message","modelValue"]),(0,n.createElementVNode)("div",gn,[(0,n.createVNode)(r,{name:"defaultView",label:"Visualització per defecte",disabled:(0,n.unref)(g),"model-value":(0,n.unref)(g)||y.defaultView,"onUpdate:modelValue":a[2]||(a[2]=e=>y.defaultView=e)},null,8,["disabled","model-value"]),(0,n.createVNode)(r,{name:"saveFilter",label:"Guardar el filtre actual",modelValue:y.saveFilter,"onUpdate:modelValue":a[3]||(a[3]=e=>y.saveFilter=e)},null,8,["modelValue"])]),(0,n.createVNode)(i,{class:"separatorColumnes","align-content":"center"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,null,{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)("Columnes")])),_:1})])),_:1}),(0,n.createVNode)((0,n.unref)(yn),{class:"fields",fields:(0,n.unref)(f),modelValue:y.selectedFields,"onUpdate:modelValue":[a[4]||(a[4]=e=>y.selectedFields=e),a[5]||(a[5]=e=>y.showErrorMessage=!1)]},null,8,["fields","modelValue"]),(0,n.createElementVNode)("div",bn,[(0,n.createVNode)(d,{primary:"",text:"Guardar",icon:"Save",onClick:h}),(0,n.createVNode)(d,{text:"Tornar",icon:"Back",onClick:w}),(0,n.createVNode)(d,{text:"Reiniciar",icon:"Refresh",onClick:x}),null!==(0,n.unref)(s)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,primary:"",class:"remove",text:"Eliminar",icon:"Delete",onClick:C})):(0,n.createCommentVNode)("v-if",!0)]),y.showErrorMessage?((0,n.openBlock)(),(0,n.createBlock)(u,{key:0,class:"errorMessage",type:"error",dismiss:"",onDismiss:a[6]||(a[6]=e=>y.showErrorMessage=!1)},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Cal seleccionar alguna columna. ")])),_:1})):(0,n.createCommentVNode)("v-if",!0)])])),_:1},8,["subtitle"])}}},Cn=(0,f.Z)(hn,[["__scopeId","data-v-09e0c131"]]);function xn(){const e=(0,n.ref)(window.opener),t=(0,n.ref)(!!window.opener),a=[];function l(e){for(const t of a)t(e.detail)}return(0,n.onScopeDispose)((()=>{window.removeEventListener("message",l)})),(0,n.readonly)({isChildWindow:t,parentWindow:e,close:function(){window.close()},onMessage:function(e){a.push(e)},sendMessage:function(t){const a=new CustomEvent("message",{detail:t});e.value?.dispatchEvent(a)}})}function wn(e,t){const a=(0,n.ref)(!1),l=qe((0,n.unref)(e)),i=(0,n.ref)();return(0,n.watch)((()=>(0,n.unref)(t)),(async t=>{a.value=!1,null!=t?await function(e,t){const a=m();return(0,o.entityLoad)(e,me,{Authorization:a.jwt},t)}(l,t):Ie((0,n.unref)(e),l),i.value=(0,o.entityData)(l,{depth:0}),a.value=!0}),{immediate:!0}),{entityLoaded:a,entity:l,initialData:i,resetEntity(){for(const e in i.value)l[e]=i.value[e]},entitySave(){Re(l)},entityDelete(){Ue(l)}}}const Nn={__name:"list-item-edit",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=ue(),d=(0,o.useValidations)(),u=et(),{goBack:s}=ia(),{sendMessage:c,close:m}=xn(),{itemId:p}=aa("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0}),{tabName:f}=aa("tabName"),{popup:y}=na("popup");u.setContextName(t.list.name),u.load(t.list.name);const{entityLoaded:v,entity:g,resetEntity:b}=wn(t.list,p),h=(0,n.ref)({});(0,n.watch)(v,(e=>{e&&(h.value=t.list.permissionDenied?.(g)??{},x&&(0,n.nextTick)((()=>{x=!1,ga(g)})))}),{immediate:!0});const C=(0,n.computed)((()=>null==p.value?!h.value.create:!h.value.edit));let x=!1;ya(),(0,n.onMounted)((()=>{v.value?ga(g):x=!0})),(0,n.onUnmounted)(va);const w=t.list.fields.find((e=>e.primary)).name,N=(0,n.computed)((()=>g[w]));d.createField(w,N);const V=(0,n.computed)((()=>t.list.form.tabs?.map((e=>({text:e.title,value:e.name,icon:e.icon,count:e.count})))??[]));function I(e){e(g)}function S(e){l.push({path:null==p.value?`/${t.list.name}/create/tab/${e}`:`/${t.list.name}/edit/${p.value}/tab/${e}`,query:{return:a.query.return,popup:y.value}})}async function B(){await d.validate(g)&&await ha((async()=>{await Re(g),s(`/${t.list.name}`,null,{reload:!0})}))}async function k(){await d.validate(g)&&await ha((async()=>{await Re(g),c({action:"save"}),m()}))}function E(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){b(),(0,n.nextTick)((()=>ga(g)))}})}function A(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",async accept(){await ha((async()=>{await Ue(g),s(`/${t.list.name}`,null,{reload:!0})}))}})}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{class:"itemListEdit-container",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.unref)(v)?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(pa),{key:0,tabs:(0,n.unref)(V),"current-tab":(0,n.unref)(f),"max-width":e.list.form.maxWidth,"self-aling":e.list.form.selfAlign,"has-save":(0,n.unref)(C)&&void 0===(0,n.unref)(y),"has-save-and-close":(0,n.unref)(C)&&void 0!==(0,n.unref)(y),"has-reset":"","has-remove":null!==(0,n.unref)(p)&&!h.value.delete,"has-go-back":void 0===(0,n.unref)(y),"has-close":void 0!==(0,n.unref)(y),"onUpdate:currentTab":S,onSave:B,onSaveAndClose:k,onReset:E,onRemove:A,onGoBack:a[0]||(a[0]=t=>(0,n.unref)(s)(`/${e.list.name}`)),onClose:(0,n.unref)(m)},{default:(0,n.withCtx)((()=>["auto"===e.list.form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ba),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(g),validations:(0,n.unref)(d),onChange:I},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.list.form.component),{key:1,entity:(0,n.unref)(g),validations:(0,n.unref)(d),onChange:I},null,40,["entity","validations"]))])),child:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{entity:(0,n.unref)(g),validations:(0,n.unref)(d),onChange:I},null,8,["entity","validations"])])),_:1},8,["tabs","current-tab","max-width","self-aling","has-save","has-save-and-close","has-remove","has-go-back","has-close","onClose"])):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["subtitle"])}}},Vn=(0,f.Z)(Nn,[["__scopeId","data-v-238d9033"]]),In={__name:"list-item-tab-subform",props:{list:{type:Object,required:!0},subform:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=(0,n.computed)((()=>t.list.entityName||t.list.name)),l=(0,n.computed)((()=>Rt(t.list,t.subform.fields(t.entity))));return(t,i)=>((0,n.openBlock)(),(0,n.createElementBlock)("div",{class:(0,n.normalizeClass)(e.subform.class)},[(0,n.createVNode)((0,n.unref)(Ct),{"with-area-name":"",fields:(0,n.unref)(l),entity:e.entity,validations:e.validations,"cache-name":(0,n.unref)(a),onChange:i[0]||(i[0]=e=>t.$emit("change",e.action))},null,8,["fields","entity","validations","cache-name"])],2))}},Sn={key:0},Bn={class:"cellactions"},kn={key:0},En={key:1},An={__name:"details-view-edit",props:{fields:{type:Array,default:()=>[]},data:{type:Array,required:!0},orderby:{type:Array,default:()=>[]},forcedOrder:{type:Boolean,default:!1},autoLayout:{type:String,default:null},compact:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["edit","create","update:orderby","clickCell"],setup(e,{emit:t}){const a=e,l=(0,n.computed)((()=>[...a.readonly?[]:[{key:"actions",width:"25px"}],...a.fields.map(((e,t)=>{if(e.primary)return null;{const n=Ve(e),l=a.orderby.find((e=>e.sentence===n));return{index:t,type:e.type,title:e.label,icon:Wt(l)}}}))]));function i(e){const{index:n}=l.value[e];if(null!=n){const l=Ve(a.fields[n]);if(l){const n=a.orderby.map((e=>({...e}))),i=n.findIndex((e=>e.sentence===l));if(i>-1){const e=n[i];"asc"===e.direction?e.direction="desc":"desc"===e.direction?a.forcedOrder?e.direction="asc":n.splice(i,1):"none"===e.direction&&(e.direction="asc")}else{const t=n.map((e=>a.fields.findIndex((t=>Ve(t)===e.sentence))));if(t.every((e=>-1===e)))n.push({sentence:l,direction:"asc"});else{const a=[...t.entries()].filter((e=>e[1]>-1)).reduce(((t,a)=>!t||Math.abs(e-a[1])<Math.abs(e-t[1])?a:t),null),i=a[1]<e?a[0]+1:a[0];n.splice(i,0,{sentence:l,direction:"asc"})}}t("update:orderby",n)}}}return(a,o)=>{const r=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-details-list");return(0,n.openBlock)(),(0,n.createBlock)(d,{columns:(0,n.unref)(l),data:e.data,"auto-layout":e.autoLayout,compact:e.compact,onClickHeader:i,onClickCell:o[1]||(o[1]=e=>t("clickCell",e))},{default:(0,n.withCtx)((l=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda.\n        @binding {number} rowIndex Índice de la fila.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {string} content Contenido de la celda.\n        @binding {object} column Referencia a la definición de la columna.\n      "),(0,n.renderSlot)(a.$slots,"default",{rowIndex:l.rowIndex,row:e.data[l.rowIndex],columnIndex:l.columnIndex,column:l.column,content:l.content},(()=>["actions"===l.column.key?((0,n.openBlock)(),(0,n.createElementBlock)("div",Sn,[(0,n.createElementVNode)("div",Bn,[(0,n.createVNode)(r,{type:"icon",icon:"Edit",onClick:e=>t("edit",l.rowIndex)},null,8,["onClick"])])])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(ht)[l.column.type].detailsCell),{key:1,field:e.fields[l.column.index],row:e.data[l.rowIndex]},null,8,["field","row"]))]))])),header:(0,n.withCtx)((e=>[(0,n.createCommentVNode)("\n        @slot Contenido de una cabecera.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {number} index Índice de la definición de la columna.\n      "),(0,n.renderSlot)(a.$slots,"header",{column:e.column,index:e.index})])),bodyHeader:(0,n.withCtx)((e=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda de un encabezado de cuerpo.\n        @binding {number} groupIndex Índice de la definición del grupo.\n        @binding {object} group Referencia a la definición del grupo.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {Array} data Datos del grupo.\n      "),(0,n.renderSlot)(a.$slots,"bodyHeader",{groupIndex:e?.groupIndex,group:e?.group,columnIndex:e?.columnIndex,column:e?.column,data:e?.data})])),bodyFooter:(0,n.withCtx)((l=>[(0,n.createCommentVNode)("\n        @slot Contenido de una celda de un pie de cuerpo.\n        @binding {number} groupIndex Índice de la definición del grupo.\n        @binding {object} group Referencia a la definición del grupo.\n        @binding {number} columnIndex Índice de la definición de la columna.\n        @binding {object} column Referencia a la definición de la columna.\n        @binding {Array} data Datos del grupo.\n      "),(0,n.renderSlot)(a.$slots,"bodyFooter",{groupIndex:l?.groupIndex,group:l?.group,columnIndex:l?.columnIndex,column:l?.column,data:l?.data},(()=>["actions"!==l?.column?.key||e.readonly?((0,n.openBlock)(),(0,n.createElementBlock)("div",En)):((0,n.openBlock)(),(0,n.createElementBlock)("div",kn,[(0,n.createVNode)(r,{type:"icon",icon:"Add",onClick:o[0]||(o[0]=e=>t("create"))})]))]))])),_:3},8,["columns","data","auto-layout","compact"])}}},On={__name:"list-item-tab-details",props:{list:{type:Object,required:!0},child:{type:Object,required:!0},entity:{type:Object,required:!0}},emits:["change"],setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),{orderby:i,updateOrderby:o}=na("orderby",{parse:Zt,stringify:Ht}),d=(0,n.computed)((()=>qt(t.child.listName))),u=(0,n.computed)((()=>t.child.fields.map((e=>d.value.fields.find((t=>t.name===e)))).filter((e=>e)))),s=(0,n.computed)((()=>t.entity[t.child.navigationKey||t.child.listName])),{sortedData:c}=da(s,i);function m(){const e=a.params.itemId,n=a.params.tabName;l.push({path:null==e?`/${t.list.name}/create/tab/${n}/create`:`/${t.list.name}/edit/${e}/tab/${n}/create`,query:a.query})}function p(e){const n=a.params.itemId,i=a.params.tabName;l.push({path:null==n?`/${t.list.name}/create/tab/${i}/edit/${e}`:`/${t.list.name}/edit/${n}/tab/${i}/edit/${e}`,query:a.query})}return(a,l)=>{const r=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)((0,n.unref)(An),{fields:(0,n.unref)(u),data:(0,n.unref)(c),orderby:(0,n.unref)(i),"auto-layout":e.child.autoLayout,readonly:e.child.readonly||!e.child.form,compact:"",onCreate:m,onEdit:p,"onUpdate:orderby":l[0]||(l[0]=e=>(0,n.unref)(o)(e))},null,8,["fields","data","orderby","auto-layout","readonly"]),(0,n.createVNode)(r,{list:e.list,entity:t.entity,onChange:l[1]||(l[1]=e=>a.$emit("change",e))},null,8,["list","entity"])],64)}}},Dn={__name:"list-item-tab",props:{list:{type:Object,required:!0},entity:{type:Object,required:!0},validations:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const a=e,{tabName:l}=aa("tabName"),i=(0,n.computed)((()=>a.list.form.tabs.find((e=>e.name===l.value))));return(a,l)=>"child"===(0,n.unref)(i).type?((0,n.openBlock)(),(0,n.createBlock)(On,{key:0,list:e.list,child:(0,n.unref)(i),entity:e.entity,onChange:l[0]||(l[0]=e=>t("change",e))},null,8,["list","child","entity"])):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},["auto"===(0,n.unref)(i).component?((0,n.openBlock)(),(0,n.createBlock)(In,{key:0,list:e.list,subform:(0,n.unref)(i),entity:e.entity,validations:e.validations,onChange:l[1]||(l[1]=e=>t("change",e))},null,8,["list","subform","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(i).component),{key:1,list:e.list,child:(0,n.unref)(i),entity:e.entity,validations:e.validations,onChange:l[2]||(l[2]=e=>t("change",e))},null,40,["list","child","entity","validations"]))],64))}},$n={__name:"list-item-tab-child",props:{list:{type:Object,required:!0},entity:{type:Object,required:!0},splitted:{type:Boolean,default:!1}},emits:["change"],setup(e,{emit:t}){const a=e;(0,n.useCssVars)((e=>({"4c00a527":(0,n.unref)(S)})));const l=(0,r.useRoute)(),i=(0,r.useRouter)(),d=ue(),u=(0,o.useValidations)(),{sendMessage:s}=xn(),c=(0,n.ref)(!1),{itemId:m}=aa("itemId",{parse:e=>null!=e?Number(e):null}),{childId:p}=aa("childId",{parse:e=>e?Number(e):null,handleLeave:!0}),{tabName:f}=aa("tabName"),{popup:y}=na("popup"),v=(0,n.computed)((()=>a.list.permissionDenied?.(a.entity)??{})),g=(0,n.computed)((()=>null==m.value?!v.value.create:!v.value.edit)),b=(0,n.computed)((()=>a.list.form.tabs.find((e=>e.name===f.value)))),h=(0,n.computed)((()=>qt(b.value.listName))),C=(0,n.ref)({}),x=(0,n.getCurrentScope)();function w(e){const t=b.value.navigationKey||b.value.listName;null==e?(C.value=a.entity[t].create(),Ie(h.value,C.value,{notOverwrite:!0})):C.value=(0,o.entityClone)(a.entity[t][e],{scope:x}),c.value&&(0,n.nextTick)((()=>ga(C.value)))}ya(),(0,n.onMounted)((()=>{c.value=!0,w(p.value)})),(0,n.onUnmounted)(va);const N=a.list.fields.find((e=>e.primary)).name,V=(0,n.computed)((()=>C.value[N]));u.createField(N,V);const I=(0,n.computed)((()=>null===p.value?"Entrada nou element":"Modificació")),S=(0,n.computed)((()=>b.value.form.maxWidth));function B(e){e(C.value)}async function k(){if(await u.validate(C.value)){const e=b.value.navigationKey||b.value.listName;return a.splitted?await ha((async()=>{if(await Re(C.value),null==p.value){const e=b.value.navigationKey||b.value.listName;a.entity[e].add(C.value)}void 0!==y.value&&s({action:"save"})})):null==p.value?t("change",(t=>{t[e].add(C.value)})):t("change",(t=>{(0,o.entitySyncState)(t[e][p.value],C.value)})),!0}return!1}function E(){c.value=!1,(0,n.nextTick)((()=>i.push({path:null===m.value?`/${a.list.name}/create/tab/${f.value}`:`/${a.list.name}/edit/${m.value}/tab/${f.value}`,query:l.query})))}async function A(){await k()&&E()}async function O(){await k()&&(i.push({path:null===m.value?`/${a.list.name}/create/tab/${f.value}/create`:`/${a.list.name}/edit/${m.value}/tab/${f.value}/create`,query:l.query}),w())}function D(){d.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){w(p.value)}})}function $(){d.confirm({title:"Alerta!",message:"Esteu segurs de que voleu esborrar aquest element?. Aquesta acció no es pot desfer.",async accept(){const e=b.value.navigationKey||b.value.listName;a.splitted?await ha((async()=>{await Ue(C.value)})):t("change",(t=>{t[e].delete(p.value)})),E()}})}return(e,t)=>{const a=(0,n.resolveComponent)("fura-dialog"),l=(0,n.resolveComponent)("fura-overlay"),i=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(i,{open:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"listItemEditTabChild-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[c.value?((0,n.openBlock)(),(0,n.createBlock)(a,{key:0,class:"listItemEditTabChild-dialog",header:(0,n.unref)(I)},{default:(0,n.withCtx)((()=>[(0,n.createVNode)((0,n.unref)(pa),{"max-width":(0,n.unref)(S),"self-aling":(0,n.unref)(b).form.selfAlign,"has-save":(0,n.unref)(g),"has-save-and-new":(0,n.unref)(g),"has-reset":"","has-remove":null!==(0,n.unref)(p)&&((0,n.unref)(g)||!(0,n.unref)(v).delete),"has-go-back":"",onSave:A,onSaveAndNew:O,onReset:D,onRemove:$,onGoBack:E},{default:(0,n.withCtx)((()=>["auto"===(0,n.unref)(b).form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ba),{key:0,list:(0,n.unref)(h),form:(0,n.unref)(b).form,entity:C.value,validations:(0,n.unref)(u),onChange:B},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)((0,n.unref)(b).form.component),{key:1,entity:C.value,validations:(0,n.unref)(u),onChange:B},null,40,["entity","validations"]))])),_:1},8,["max-width","self-aling","has-save","has-save-and-new","has-remove"])])),_:1},8,["header"])):(0,n.createCommentVNode)("v-if",!0)])),_:1})])),_:1})}}},Tn=(0,f.Z)($n,[["__scopeId","data-v-5697d378"]]),_n={class:"dialogFooter"},Fn={__name:"list-item-delete",props:{list:{type:Object,required:!0}},setup(e){const t=e,a=(0,r.useRouter)(),l=(0,r.useRoute)(),{itemId:i}=aa("itemId",{parse:e=>null!=e?Number(e):null,stringify:e=>null!=e?String(e):void 0});function o(){a.push({path:`/${t.list.name}/view/query/${l.query.viewName}`,query:{...l.query,viewName:void 0}})}return(r,d)=>{const u=(0,n.resolveComponent)("fura-button"),s=(0,n.resolveComponent)("fura-dialog"),c=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{class:"itemListEdit-container","hide-menu":"",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(c,{class:"modalOverlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(s,{class:"dialogMessage",type:"close",header:"Confirmació d'eliminació",text:"Esteu segurs que voleu esborrar l'element?",onClick:o},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",_n,[(0,n.createVNode)(u,{primary:"",text:"Eliminar",onClick:d[0]||(d[0]=e=>async function(){await ha((async()=>{await we(`${t.list.name}(${i.value})`),a.push({path:`/${t.list.name}/view/query/${l.query.viewName}`,query:{...l.query,selectedItemId:void 0,viewName:void 0}})}))}())}),(0,n.createVNode)(u,{text:"Cancel·lar",onClick:o})])])),_:1})])),_:1})])),_:1},8,["subtitle"])}}};function qn(e){return[{path:`/${e.name}`,component:ka,props:{list:e}},{path:`/${e.name}/view/query/:viewName`,component:Ea,props:{list:e},children:[{path:"filter",component:Ja,props:{list:e}},{path:"export",component:dn,props:{list:e}}]},{path:`/${e.name}/view/grid/:viewName`,component:ja,props:{list:e}},{path:`/${e.name}/view/create`,component:Cn,props:{list:e}},{path:`/${e.name}/view/edit/:viewName`,component:Cn,props:{list:e}},{path:`/${e.name}/create`,component:Vn,props:{list:e},children:[{path:"tab/:tabName",component:Dn,props:{list:e},children:[{path:"create",component:Tn,props:{list:e}},{path:"edit/:childId",component:Tn,props:{list:e}}]}]},{path:`/${e.name}/edit/:itemId`,component:Vn,props:{list:e},children:[{path:"tab/:tabName",component:Dn,props:{list:e},children:[{path:"create",component:Tn,props:{list:e}},{path:"edit/:childId",component:Tn,props:{list:e}}]}]},{path:`/${e.name}/delete/:itemId`,component:Fn,props:{list:e}}]}const Rn={__name:"list-item-create",props:{list:{type:Object,required:!0},splitted:{type:Boolean,default:!1}},setup(e){const t=e,a=(0,r.useRoute)(),l=(0,r.useRouter)(),i=ue(),d=(0,o.useValidations)(),u=et(),{goBack:s}=ia(),{sendMessage:c,close:m}=xn(),{tabName:p}=aa("tabName"),{popup:f}=na("popup");u.setContextName(t.list.name),u.load(t.list.name);const{entityLoaded:y,entity:v,resetEntity:g}=wn(t.list);ya(),(0,n.onMounted)((()=>ga(v))),(0,n.onUnmounted)(va);const b=t.list.fields.find((e=>e.primary)).name,h=(0,n.computed)((()=>v[b]));d.createField(b,h);const C=(0,n.computed)((()=>t.list.permissionDenied?.()??{})),x=(0,n.computed)((()=>t.list.form.tabs?.filter((e=>"child"!==e.type))?.map((e=>({text:e.title,value:e.name,icon:e.icon,count:e.count})))??[]));function w(e){e(v)}function N(e){l.push({path:`/${t.list.name}/create/tab/${e}`,query:{return:a.query.return,popup:f.value}})}async function V(){await d.validate(v)&&await ha((async()=>{await Re(v),s(`/${t.list.name}`,null,{reload:!0})}))}async function I(){await d.validate(v)&&await ha((async()=>{await Re(v),c({action:"save"}),m()}))}function S(){i.confirm({title:"Alerta!",message:"Esteu segurs de que voleu desfer els canvis realitzats?.",accept(){g(),(0,n.nextTick)((()=>ga(v)))}})}return(t,a)=>{const l=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{class:"itemListEdit-container",subtitle:e.list.label},{default:(0,n.withCtx)((()=>[(0,n.unref)(y)?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(pa),{key:0,tabs:(0,n.unref)(x),"current-tab":(0,n.unref)(p),"max-width":e.list.form.maxWidth,"self-aling":e.list.form.selfAlign,"has-save":!(0,n.unref)(C).create&&void 0===(0,n.unref)(f),"has-save-and-close":!(0,n.unref)(C).create&&void 0!==(0,n.unref)(f),"has-reset":"","has-go-back":void 0===(0,n.unref)(f),"has-close":void 0!==(0,n.unref)(f),"onUpdate:currentTab":N,onSave:V,onSaveAndClose:I,onReset:S,onGoBack:a[0]||(a[0]=t=>(0,n.unref)(s)(`/${e.list.name}`)),onClose:(0,n.unref)(m)},{default:(0,n.withCtx)((()=>["auto"===e.list.form.component?((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(ba),{key:0,list:e.list,form:e.list.form,entity:(0,n.unref)(v),validations:(0,n.unref)(d),onChange:w},null,8,["list","form","entity","validations"])):((0,n.openBlock)(),(0,n.createBlock)((0,n.resolveDynamicComponent)(e.list.form.component),{key:1,entity:(0,n.unref)(v),validations:(0,n.unref)(d),onChange:w},null,40,["entity","validations"]))])),child:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{entity:(0,n.unref)(v),validations:(0,n.unref)(d),onChange:w},null,8,["entity","validations"])])),_:1},8,["tabs","current-tab","max-width","self-aling","has-save","has-save-and-close","has-go-back","has-close","onClose"])):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["subtitle"])}}},Un=(0,f.Z)(Rn,[["__scopeId","data-v-a1813330"]]);function jn(e){return[{path:`/${e.name}`,component:ka,props:{list:e}},{path:`/${e.name}/view/query/:viewName`,component:Ea,props:{list:e},children:[{path:"filter",component:Ja,props:{list:e}},{path:"export",component:dn,props:{list:e}}]},{path:`/${e.name}/view/grid/:viewName`,component:ja,props:{list:e}},{path:`/${e.name}/view/create`,component:Cn,props:{list:e}},{path:`/${e.name}/view/edit/:viewName`,component:Cn,props:{list:e}},{path:`/${e.name}/create`,component:Un,props:{list:e},children:[{path:"tab/:tabName",component:Dn,props:{list:e},children:[{path:"create",component:Tn,props:{list:e,splitted:!0}},{path:"edit/:childId",component:Tn,props:{list:e,splitted:!0}}]}]},{path:`/${e.name}/edit/:itemId`,component:Vn,props:{list:e,splitted:!0},children:[{path:"tab/:tabName",component:Dn,props:{list:e},children:[{path:"create",component:Tn,props:{list:e,splitted:!0}},{path:"edit/:childId",component:Tn,props:{list:e,splitted:!0}}]}]},{path:`/${e.name}/delete/:itemId`,component:Fn,props:{list:e}}]}const Pn={dictionary:e,listJoined:t,listSplitted:a},Mn={class:"layout"},Kn={class:"form"},Ln={class:"logo"},zn=["src"],Gn=["onSubmit"],Wn={class:"label"},Zn=["textContent"],Hn=(e=>((0,n.pushScopeId)("data-v-a4814732"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("br",null,null,-1))),Xn={class:"buttons"},Yn={class:"recovery"},Qn={__name:"user-login",setup(e){const t=(0,r.useRouter)(),a=m(),l=ue(),i=(0,n.reactive)({username:"",password:""});async function o(e){l.loadStart("user-login");const n=await fetch(`${me}/authenticator/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(200===n.status){const e=await n.text();a.setJwt(e),t.push(he)}else if(401===n.status){const e=await n.text();l.alert({title:"Error:",message:e})}else l.alert({title:"Error:",message:"Error inesperat."});l.loadEnd("user-login")}return(0,n.onMounted)((()=>{a.jwt&&t.push(he)})),(e,a)=>{const l=(0,n.resolveComponent)("fura-text-field"),r=(0,n.resolveComponent)("fura-button"),d=(0,n.resolveComponent)("fura-link");return(0,n.openBlock)(),(0,n.createElementBlock)("div",Mn,[(0,n.createElementVNode)("div",Kn,[(0,n.createElementVNode)("div",Ln,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(se)}/images/logo.png`,width:"160"},null,8,zn)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(o,["prevent"])},[(0,n.createElementVNode)("div",Wn,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(ce))},null,8,Zn),Hn,(0,n.createTextVNode)(" Entrada al sistema ")]),(0,n.createVNode)(l,{label:"Nom d'usuari",icon:"Contact",modelValue:i.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.username=e)},null,8,["modelValue"]),(0,n.createVNode)(l,{label:"Clau d'acces",password:"",icon:"Permissions",modelValue:i.password,"onUpdate:modelValue":a[1]||(a[1]=e=>i.password=e)},null,8,["modelValue"]),(0,n.createElementVNode)("div",Xn,[(0,n.createVNode)(r,{primary:"",text:"Entra","form-role":"submit"}),(0,n.createElementVNode)("div",Yn,[(0,n.createVNode)(d,{onClick:a[2]||(a[2]=e=>(0,n.unref)(t).push("/password-reset-request"))},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)(" Recupera la clau d'acces ")])),_:1})])])],40,Gn)])])}}},Jn=(0,f.Z)(Qn,[["__scopeId","data-v-a4814732"]]),el=e=>((0,n.pushScopeId)("data-v-2d34bbf8"),e=e(),(0,n.popScopeId)(),e),tl={class:"layout"},al={class:"form"},nl={class:"logo"},ll=["src"],il=["onSubmit"],ol={class:"label"},rl=["textContent"],dl=el((()=>(0,n.createElementVNode)("br",null,null,-1))),ul=el((()=>(0,n.createElementVNode)("br",null,null,-1))),sl={class:"buttons"},cl={__name:"user-password-reset-request",setup(e){const t=(0,r.useRouter)(),a=ue(),l=(0,n.ref)("");async function i(e){a.loadStart("password-reset"),200===(await fetch(`${me}/authenticator/requestResetPassword`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Username:l.value})})).status?a.alert({title:"Acceptat!",message:"Sol·licitud acceptada, en breu rebrà un correu electronic amb les instruccions.",close:()=>t.push("/")}):a.alert({title:"Error",message:"No s'ha trobat l'usuari."}),a.loadEnd("password-reset")}return(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),o=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",tl,[(0,n.createElementVNode)("div",al,[(0,n.createElementVNode)("div",nl,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(se)}/images/logo.png`,width:"160"},null,8,ll)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(i,["prevent"])},[(0,n.createElementVNode)("div",ol,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(ce))},null,8,rl),dl,(0,n.createTextVNode)(" Sol·licitar una nova clau d'accés "),ul]),(0,n.createVNode)(a,{label:"Nom d'usuari o adreça de correu electronic",icon:"Contact",modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e)},null,8,["modelValue"]),(0,n.createElementVNode)("div",sl,[(0,n.createVNode)(o,{primary:"",text:"Sol·licitar canvi de clau d'acces","form-role":"submit"})])],40,il)])])}}},ml=(0,f.Z)(cl,[["__scopeId","data-v-2d34bbf8"]]),pl=e=>((0,n.pushScopeId)("data-v-f7cedc74"),e=e(),(0,n.popScopeId)(),e),fl={class:"layout"},yl={class:"form"},vl={class:"logo"},gl=["src"],bl=["onSubmit"],hl={class:"label"},Cl=["textContent"],xl=pl((()=>(0,n.createElementVNode)("br",null,null,-1))),wl=pl((()=>(0,n.createElementVNode)("br",null,null,-1))),Nl={class:"showChars"},Vl={class:"buttons"},Il={__name:"user-password-reset",setup(e){const t=(0,r.useRoute)(),a=(0,r.useRouter)(),l=ue(),i=(0,n.ref)(""),o=(0,n.ref)(""),d=(0,n.ref)(!1);async function u(e){l.loadStart("password-reset");const n=await fetch(`${me}/authenticator/resetPassword`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:t.query.token},body:JSON.stringify({password:i.value})});if(200===n.status)l.alert({title:"Atenció!",message:"S'ha actualitzat la clau d'acces.",close:()=>a.push("/")});else if(401===n.status){const e=await n.text();l.alert({title:"Error",message:e})}else l.alert({title:"Error",message:"Error inesperat"});l.loadEnd("password-reset")}return(0,n.onMounted)((()=>{t.query.token||a.push("/")})),(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),l=(0,n.resolveComponent)("fura-toggle"),r=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createElementBlock)("div",fl,[(0,n.createElementVNode)("div",yl,[(0,n.createElementVNode)("div",vl,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(se)}/images/logo.png`,width:"160"},null,8,gl)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(u,["prevent"])},[(0,n.createElementVNode)("div",hl,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(ce))},null,8,Cl),xl,(0,n.createTextVNode)(" Establir la clau d'accés "),wl]),(0,n.createVNode)(a,{label:"Clau d'acces",password:!d.value,icon:"Permissions",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Repetir clau d'acces",password:!d.value,icon:"RepeatAll",modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e)},null,8,["password","modelValue"]),(0,n.createElementVNode)("div",Nl,[(0,n.createVNode)(l,{inline:"",label:"Mostrar caracters ",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e)},null,8,["modelValue"])]),(0,n.createElementVNode)("div",Vl,[(0,n.createVNode)(r,{primary:"",text:"Canviar clau",disabled:!i.value||i.value!==o.value,"form-role":"submit"},null,8,["disabled"])])],40,bl)])])}}},Sl=(0,f.Z)(Il,[["__scopeId","data-v-f7cedc74"]]),Bl={class:"layout"},kl={class:"form"},El={class:"logo"},Al=["src"],Ol=["onSubmit"],Dl={class:"label"},$l=["textContent"],Tl=(e=>((0,n.pushScopeId)("data-v-281eab33"),e=e(),(0,n.popScopeId)(),e))((()=>(0,n.createElementVNode)("br",null,null,-1))),_l={class:"showChars"},Fl={class:"buttons"},ql={__name:"user-password-change",setup(e){const t=(0,r.useRouter)(),a=m(),l=ue(),i=(0,n.ref)(""),o=(0,n.ref)(""),d=(0,n.ref)(""),u=(0,n.ref)(!1);async function s(e){l.loadStart("password-reset");const n=await fetch(`${me}/authenticator/changePassword`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:a.jwt},body:JSON.stringify({oldPassword:i.value,newPassword:o.value})});if(406===n.status)l.alert({title:"Error",message:"Antiga clau d'acces incorrecte."});else if(200===n.status)l.alert({title:"Atenció!",message:"S'ha actualitzat la clau d'acces.",close:()=>{a.setJwt(),t.push("/")}});else if(401===n.status){const e=await n.text();l.alert({title:"Error",message:e})}else l.alert({title:"Error",message:"Error inesperat"});l.loadEnd("password-reset")}return(e,t)=>{const a=(0,n.resolveComponent)("fura-text-field"),l=(0,n.resolveComponent)("fura-toggle"),r=(0,n.resolveComponent)("fura-button");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{class:"baseLayout",subtitle:"Canvi de clau d'acces"},{default:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Bl,[(0,n.createElementVNode)("div",kl,[(0,n.createElementVNode)("div",El,[(0,n.createElementVNode)("img",{src:`/${(0,n.unref)(se)}/images/logo.png`,width:"160"},null,8,Al)]),(0,n.createElementVNode)("form",{onSubmit:(0,n.withModifiers)(s,["prevent"])},[(0,n.createElementVNode)("div",Dl,[(0,n.createElementVNode)("span",{style:{"font-weight":"600"},textContent:(0,n.toDisplayString)((0,n.unref)(ce))},null,8,$l),Tl,(0,n.createTextVNode)(" Canviar la paraula clau ")]),(0,n.createVNode)(a,{class:"oldPassword",label:"Antiga clau d'acces",password:!u.value,icon:"Permissions",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Nova clau d'acces",password:!u.value,icon:"PasswordField",modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e)},null,8,["password","modelValue"]),(0,n.createVNode)(a,{label:"Repetir nova clau d'acces",password:!u.value,icon:"RepeatAll",modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e)},null,8,["password","modelValue"]),(0,n.createElementVNode)("div",_l,[(0,n.createVNode)(l,{inline:"",label:"Mostrar caracters ",modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=e=>u.value=e)},null,8,["modelValue"])]),(0,n.createElementVNode)("div",Fl,[(0,n.createVNode)(r,{primary:"",text:"Canviar clau",disabled:!o.value||o.value!==d.value,"form-role":"submit"},null,8,["disabled"])])],40,Ol)])])])),_:1})}}},Rl=(0,f.Z)(ql,[["__scopeId","data-v-281eab33"]]),Ul={__name:"home-view",setup:e=>(e,t)=>((0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{subtitle:"Inici"}))},jl={class:"notFound-buttons"},Pl={__name:"not-found",setup:e=>(e,t)=>{const a=(0,n.resolveComponent)("fura-button"),l=(0,n.resolveComponent)("fura-dialog"),i=(0,n.resolveComponent)("fura-overlay");return(0,n.openBlock)(),(0,n.createBlock)((0,n.unref)(Gt),{subtitle:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"notFound-overlay"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{class:"notFound-dialog",header:"Error!",text:"Aquesta pàgina no esta definida."},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",jl,[(0,n.createVNode)(a,{icon:"Home",text:"Ves al inci",onClick:t[0]||(t[0]=t=>e.$router.push((0,n.unref)(he)))}),(0,n.createVNode)(a,{icon:"Back",text:"Torna enrere.",onClick:t[1]||(t[1]=t=>e.$router.go(-1))})])])),_:1})])),_:1})])),_:1})}},Ml=(0,f.Z)(Pl,[["__scopeId","data-v-5023a390"]]),Kl=[];for(const e of qt()){const t=Pn[e.type];t&&t.getRoutes&&Kl.push(...t.getRoutes(e))}const Ll=(0,r.createRouter)({history:(0,r.createWebHistory)(),routes:Kl.concat([{path:"/",component:Jn,meta:{anonymousAccess:!0}},{path:"/password-reset-request",component:ml,meta:{anonymousAccess:!0}},{path:"/password-reset",component:Sl,meta:{anonymousAccess:!0}},{path:"/password-change",component:Rl},{path:"/home",component:Ul},{path:"/:catchAll(.*)",component:Ml}])});Ll.beforeEach((e=>{const t=m();if(!e.meta.anonymousAccess&&!t.jwt)return{path:"/",query:{redirect:e.fullPath}}}));const zl=Ll,Gl={__name:"dialog-loading",setup(e){const t=ue();return(e,a)=>{const l=(0,n.resolveComponent)("fura-spinner"),i=(0,n.resolveComponent)("fura-dialog"),o=(0,n.resolveComponent)("fura-overlay"),r=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(r,{open:(0,n.unref)(t).loading.size>0},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(o,{class:"dialogLoading-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(i,{class:"dialogLoading-loading"},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(l,{label:"Carregant..."})])),_:1})])),_:1})])),_:1},8,["open"])}}},Wl=(0,f.Z)(Gl,[["__scopeId","data-v-69be9a34"]]),Zl={class:"dialogAlert-close"},Hl={__name:"dialog-alert",setup(e){const t=ue(),a=(0,n.computed)((()=>t.alertList.length>0)),l=(0,n.computed)((()=>t.alertList[0]));return(e,i)=>{const o=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),d=(0,n.resolveComponent)("fura-overlay"),u=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(u,{open:(0,n.unref)(a)},{default:(0,n.withCtx)((()=>[(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,class:"dialogAlert-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogAlert-dialog",type:"close",header:(0,n.unref)(l).title,text:(0,n.unref)(l).message,onClick:i[1]||(i[1]=e=>(0,n.unref)(t).alertClose())},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Zl,[(0,n.createVNode)(o,{text:"Tancar",onClick:i[0]||(i[0]=e=>(0,n.unref)(t).alertClose())})])])),_:1},8,["header","text"])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["open"])}}},Xl=(0,f.Z)(Hl,[["__scopeId","data-v-69b9f90a"]]),Yl={class:"dialogConfirm-close"},Ql={__name:"dialog-confirm",setup(e){const t=ue(),a=(0,n.computed)((()=>t.confirmList.length>0)),l=(0,n.computed)((()=>t.confirmList[0]));return(e,i)=>{const o=(0,n.resolveComponent)("fura-button"),r=(0,n.resolveComponent)("fura-dialog"),d=(0,n.resolveComponent)("fura-overlay"),u=(0,n.resolveComponent)("fura-modal");return(0,n.openBlock)(),(0,n.createBlock)(u,{open:(0,n.unref)(a)},{default:(0,n.withCtx)((()=>[(0,n.unref)(a)?((0,n.openBlock)(),(0,n.createBlock)(d,{key:0,class:"dialogConfirm-overlay",fixed:"",dark:""},{default:(0,n.withCtx)((()=>[(0,n.createVNode)(r,{class:"dialogConfirm-dialog",header:(0,n.unref)(l).title,text:(0,n.unref)(l).message},{footer:(0,n.withCtx)((()=>[(0,n.createElementVNode)("div",Yl,[(0,n.createVNode)(o,{primary:"",text:(0,n.unref)(l).confirmButton||"Si",onClick:i[0]||(i[0]=e=>(0,n.unref)(t).confirmAccept())},null,8,["text"]),(0,n.createVNode)(o,{text:(0,n.unref)(l).cancelButton||"No",onClick:i[1]||(i[1]=e=>(0,n.unref)(t).confirmCancel())},null,8,["text"])])])),_:1},8,["header","text"])])),_:1})):(0,n.createCommentVNode)("v-if",!0)])),_:1},8,["open"])}}},Jl=(0,f.Z)(Ql,[["__scopeId","data-v-0cb2bae0"]]),ei={__name:"app",setup:e=>(Be(),Ia(),(e,t)=>{const a=(0,n.resolveComponent)("router-view");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createVNode)(a),(0,n.createVNode)((0,n.unref)(Wl)),(0,n.createVNode)((0,n.unref)(Xl)),(0,n.createVNode)((0,n.unref)(Jl))],64)})},ti=(0,n.createApp)(ei);ti.use((0,l.createPinia)()),ti.use(i),ti.use(o),ti.use(zl),ti.mount("#app");const ai=ti})(),s.default})()));